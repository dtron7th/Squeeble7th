<!DOCTYPE html>
<html lang="en">
<head style="display: none;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@200..900&display=swap" rel="stylesheet">


    <!--Book_Mark: Root_System-->

    <!-- :Root -->
    <style aria-label="Root">
        :root {

            --Main_UI_Color: rgb(0, 0, 0);
            --Header_UI_Color: rgba(0, 0, 0, 0);
            --Main_UI_Blur: 0px;
            --Main_UI_Border: 1px solid rgba(255, 255, 255, 0.178);
            
            --Main_UI_Border_Radius_Window: 0px;
            --Main_UI_Border_Radius_Button: 0px;

            --Main_Text_Color: rgb(255, 255, 255);

            --Main_Font_Size: 11px;

            --Box_Shadow: 0px 0px 10px rgba(0, 0, 0, 0.6);

            --Terminal_Background_Color: rgb(0, 0, 0);
            --Terminal_Text_Color: rgb(255, 255, 255);
            
        }

        /* ---- Global Terminal Cursor ---- */
        .terminal {
            caret-color: transparent;
        }
        .terminal-cursor {
            display: inline-block;
            width: 5px;
            height: 1.2em;
            background-color: var(--Terminal_Text_Color, #0f0);
            vertical-align: text-bottom;
            animation: terminal-blink 0.5s step-end infinite;
        }
        .terminal-cursor.hidden {
            display: none;
        }
        @keyframes terminal-blink {
            50% { opacity: 0; }
        }
        @keyframes terminal-prompt-jump {
            0% { transform: translateY(0); }
            50% { transform: translateY(-2px); }
            100% { transform: translateY(0); }
        }
        .terminal-cursor {
            transition: none !important;
        }
        .terminal-cursor.prompt-jump {
            animation: terminal-prompt-jump 0.18s ease-out, terminal-blink 0.5s step-end infinite;
        }
        
        /* Allow all animations to work normally */
        .terminal-cursor {
            animation: terminal-blink 0.5s step-end infinite;
        }
    </style>



    <!--Book_Mark: Head : UI_Build-->
    <!-- UI -->
    <div aria-label="Build_UI">

        <!--Window-->
        <div class="Window">
            <div class="Header">
                <p class="Title"></p>
                <div class="Window_Manipulation">
                    <button class="Window_Minimize"></button>
                    <button class="Window_Maximize"></button>
                    <button class="Window_Close"></button>

                    <style aria-label="Window_Manipulation - Style">
                        .Window_Manipulation {
                            position: absolute;
                            right: 10px;
                            display: flex;
                            gap: 10px;
                        }

                        .Window_Manipulation > button {
                            width: 10px;
                            height: 10px;
                            border-radius: 50%;
                        }
                        .Window_Manipulation > .Window_Minimize {
                            background-color: rgb(255, 255, 0);
                        }

                        .Window_Manipulation > .Window_Maximize {
                            background-color: rgb(0, 255, 0);
                        }

                        .Window_Manipulation > .Window_Close {
                            background-color: rgb(255, 0, 0);
                        }


                    </style>

                    <script aria-label="Window_Manipulation - Script">

                    </script>
                </div>

                <style aria-label="Header - Style">
                    
                </style>

                <script aria-label="Header - Script">

                </script>

            </div>
            <div class="Content">
                <style aria-label="Content - Style">

                </style>

                <script aria-label="Content - Script">
                    
                </script>
            </div>

            <style aria-label="Window - Style">

            </style>

            <script aria-label="Window - Script">

            </script>
        </div>


         <div class="Terminal">
            <div class="Header">
                <p class="Title"></p>
                <div class="Terminal_Manipulation">
                    <button class="Terminal_Minimize"></button>
                    <button class="Terminal_Maximize"></button>
                    <button class="Terminal_Close"></button>

                    <style aria-label="Terminal_Manipulation - Style">
                        .Terminal_Manipulation {
                            position: absolute;
                            right: 10px;
                            display: flex;
                            gap: 10px;
                        }

                        .Terminal_Manipulation > button {
                            width: 10px;
                            height: 10px;
                            border-radius: 50%;
                        }
                        .Terminal_Manipulation > .Terminal_Minimize {
                            background-color: rgb(255, 255, 0);
                        }

                        .Terminal_Manipulation > .Terminal_Maximize {
                            background-color: rgb(0, 255, 0);
                        }

                        .Terminal_Manipulation > .Terminal_Close {
                            background-color: rgb(255, 0, 0);
                        }


                    </style>

                    <script aria-label="Terminal_Manipulation - Script">

                    </script>
                </div>

                <style aria-label="Header - Style">
                    
                </style>

                <script aria-label="Header - Script">

                </script>

            </div>
            <div class="Content">
                <style aria-label="Content - Style">

                </style>

                <script aria-label="Content - Script">
                    
                </script>
            </div>

            <style aria-label="Terminal - Style">

            </style>

            <script aria-label="Terminal - Script">

            </script>
        </div>

        <!--Panel-->
        <div class="Panel" id="">
            <p class="Title"></p>
            <button class="Panel_Close"></button>
            <div class="Panel_Buttons">

                <style aria-label="Panel_Buttons - Style">

                </style>

                <script aria-label="Panel_Buttons - Script">

                </script>
            </div>
            <style aria-label="Panel - Style">
                
            </style>

            <script aria-label="Panel - Script">

            </script>
        </div>
    </div>

    <!--Book_Mark: Head : Main_Style-->
        
    <!-- Main -->
    <style aria-label="Main">
        * {
            padding: 0px;
            margin: 0px;
            font-family: "Inconsolata", monospace;
            
        }

        body {
            background-color: rgb(0, 0, 0);
        }
    </style>
    
    <!--Book_Mark: UI_Style-->
    
    <!-- Main UI -->
    <style aria-label="UI">

        button {
            width: auto;
            height: auto;
            border: none;
            outline: none;
            background: none;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: var(--Main_Font_Size);
            border-radius: var(--Main_UI_Border_Radius_Button);
            color: var(--Main_Text_Color);
            -webkit-tap-highlight-color: transparent;
        }

        button:active {
            background-color: var(--Main_UI_Color);
        }

        .Panel {
            position: absolute;
            background-color: var(--Main_UI_Color);
            backdrop-filter: blur(var(--Main_UI_Blur));
            border: var(--Main_UI_Border);
            border-radius: var(--Main_UI_Border_Radius_Window);
            box-shadow: var(--Box_Shadow);
            display: flex;
            justify-content: center;
            align-items: center;
            display: none;

        }

        .Panel > .Title {
            position: absolute;
            top: 10px;
            color: var(--Main_Text_Color);
            font-size: var(--Main_Font_Size);
        }

        .Panel > .Panel_Close {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: rgb(255, 0, 0);
            color: var(--Main_Text_Color);
            font-size: var(--Main_Font_Size);
        }
        

        .Window {
            position: absolute;
            overflow: hidden;
            background-color: var(--Main_UI_Color);
            backdrop-filter: blur(var(--Main_UI_Blur));
            border: var(--Main_UI_Border);
            border-radius: var(--Main_UI_Border_Radius_Window);
            box-shadow: var(--Box_Shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
            display: none;
        }

        .Window > .Header {
            width: 100%;
            height: 30px;
            background-color: var(--Header_UI_Color);
            display: flex;
            align-items: center;
        }

        .Window > .Header > .Title {
            position: absolute;
            left: 10px;
            color: var(--Main_Text_Color);
            font-size: var(--Main_Font_Size);
        }

        .Window > .Header > .Window_Manipulation {
            position: absolute;
            right: 10px;
            display: flex;
            gap: 10px;
        }

        .Window > .Header > .Window_Manipulation > button {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .Window > .Content {
            position: absolute;
            bottom: 0px;
            width: 100%;
            height: calc(100% - 30px);
            display: flex;
            justify-content: center;
        }

        ::-webkit-scrollbar {
            width: 4px;
            height: 4px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);   
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .Terminal {
            position: absolute;
            overflow: hidden;
            top: 10px;
            left: 10px;
            width: 400px;
            height: 200px;
            background-color: var(--Main_UI_Color);
            backdrop-filter: blur(var(--Main_UI_Blur));
            border: var(--Main_UI_Border);
            border-radius: var(--Main_UI_Border_Radius_Window);
            box-shadow: var(--Box_Shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
            display: none;
        }

        .Terminal > .Header {
            width: 100%;
            height: 30px;
            background-color: var(--Header_UI_Color);
            display: flex;
            align-items: center;
        }

        .Terminal > .Header > .Title {
            position: absolute;
            left: 10px;
            color: var(--Main_Text_Color);
            font-size: var(--Main_Font_Size);
        }

        .Terminal > .Header > .Terminal_Manipulation {
            position: absolute;
            right: 10px;
            display: flex;
            gap: 10px;
        }

        .Terminal > .Header > .Terminal_Manipulation > button {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .Terminal > .Content {
            position: absolute;
            bottom: 10px;
            width: 100%;
            height: calc(100% - 40px);
            display: flex;
            justify-content: center;
        }



    </style>
    
    <!-- Prefabs -->
    <div class="Prefab">
        <div class="Build">

        </div>
        <style>

        </style>
        <Script>

        </Script>
    </div>

    <div aria-label="Componets">

        <!--Book_Mark: Clock-->
        <div class="_Clock">
            <p id="_Time">00:00:00:000</p>
            <p id="_Date">00/00/0000</p>

            <style aria-label="Login_Build_Clock - Style">
                ._Clock {
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    display: none;
                }

                ._Clock > p {
                    font-size: var(--Main_Font_Size);
                    color: rgb(255, 255, 255);
                }
                
                ._Clock > #_Date {
                    position: absolute;
                    right: 0px;
                }
            </style>

            <script aria-label="_Clock - Script">
                function updateClock() {
                    const now = new Date();
                    const hours = String(now.getHours()).padStart(2, '0');
                    const minutes = String(now.getMinutes()).padStart(2, '0');
                    const seconds = String(now.getSeconds()).padStart(2, '0');
                    const milliseconds = String(now.getMilliseconds()).padStart(3, '0');
                    document.getElementById('_Time').textContent = `${hours}:${minutes}:${seconds}:${milliseconds}`;
                    
                    const day = String(now.getDate()).padStart(2, '0');
                    const month = String(now.getMonth() + 1).padStart(2, '0');
                    const year = now.getFullYear();
                    document.getElementById('_Date').textContent = `${day}/${month}/${year}`;
                }
                updateClock();
                setInterval(updateClock, 10);
                
            </script>
        </div>

        <!--Book_Mark:  Components-->

        <div class="_Printable_Information">
            <p id="_Printable_Information_Wifi_Conntected"></p>
            
            <style aria-label="_Printable_Information - Style">
                ._Printable_Information {
                    position: absolute;
                    top: 60px;
                    right: 10px;
                    font-size: var(--Main_Font_Size);
                    display: none;
                }
            </style>
            <script aria-label="_Printable_Information - Script">

                const _Printable_Information_wifiElement = document.getElementById('_Printable_Information_Wifi_Conntected');

                    function updateWifiStatus() {
                        if (navigator.onLine) {
                            _Printable_Information_wifiElement.textContent = 'Wifi Connected';
                            _Printable_Information_wifiElement.style.color = 'green';
                        } else {
                            _Printable_Information_wifiElement.textContent = 'Wifi Disconnected';
                            _Printable_Information_wifiElement.style.color = 'red';
                        }
                    }

                    updateWifiStatus();
                    window.addEventListener('online', updateWifiStatus);
                    window.addEventListener('offline', updateWifiStatus);
            </script>
        </div>
    </div>

    <!--Book_Mark: Window_Manager-->

    <Script aria-label="Element_Manager">

        //Dragging system (Desktop and mobile)        


        //.Window
        (function() {
            let isDragging = false;
            let currentWindow = null;
            let offsetX = 0;
            let offsetY = 0;

            function clampPosition(x, y, element) {
                const rect = element.getBoundingClientRect();
                const maxX = window.innerWidth - rect.width;
                const maxY = window.innerHeight - rect.height;
                return {
                    x: Math.max(0, Math.min(x, maxX)),
                    y: Math.max(0, Math.min(y, maxY))
                };
            }

            document.addEventListener('mousedown', function(e) {
                const win = e.target.closest('.Window');
                if (win && !e.target.closest('.Window_Manipulation') && !window.terminalScrolling) {
                    currentWindow = win;
                    isDragging = true;
                    const rect = currentWindow.getBoundingClientRect();
                    offsetX = e.clientX - rect.left;
                    offsetY = e.clientY - rect.top;
                    currentWindow.style.cursor = 'grabbing';
                }
            });

            document.addEventListener('mousemove', function(e) {
                if (isDragging && currentWindow) {
                    const newX = e.clientX - offsetX;
                    const newY = e.clientY - offsetY;
                    const clamped = clampPosition(newX, newY, currentWindow);
                    currentWindow.style.left = clamped.x + 'px';
                    currentWindow.style.top = clamped.y + 'px';
                }
            });

            document.addEventListener('mouseup', function() {
                if (currentWindow) {
                    currentWindow.style.cursor = '';
                }
                isDragging = false;
                currentWindow = null;
            });

            // Touch support
            document.addEventListener('touchstart', function(e) {
                const win = e.target.closest('.Window');
                if (win && !e.target.closest('.Window_Manipulation') && !window.terminalScrolling) {
                    currentWindow = win;
                    isDragging = true;
                    const rect = currentWindow.getBoundingClientRect();
                    const touch = e.touches[0];
                    offsetX = touch.clientX - rect.left;
                    offsetY = touch.clientY - rect.top;
                }
            });

            document.addEventListener('touchmove', function(e) {
                if (isDragging && currentWindow) {
                    const touch = e.touches[0];
                    const newX = touch.clientX - offsetX;
                    const newY = touch.clientY - offsetY;
                    const clamped = clampPosition(newX, newY, currentWindow);
                    currentWindow.style.left = clamped.x + 'px';
                    currentWindow.style.top = clamped.y + 'px';
                    e.preventDefault();
                }
            }, { passive: false });

            document.addEventListener('touchend', function() {
                isDragging = false;
                currentWindow = null;
            });
        })();

        // Ensure opening elements stay on top
        (function() {
            function ensureOnTop(element) {
                const computedStyle = window.getComputedStyle(element);
                const isVisible = computedStyle.display !== 'none';
                const isOpening = element.classList.contains('element-opening');
                
                if (isVisible && isOpening) {
                    // Get current max z-index
                    const allElements = document.querySelectorAll('.Window, .Panel, .Terminal');
                    let maxZ = 100;
                    allElements.forEach(el => {
                        if (el !== element) {
                            const z = parseInt(window.getComputedStyle(el).zIndex) || 0;
                            if (z > maxZ) maxZ = z;
                        }
                    });
                    element.style.zIndex = Math.max(maxZ + 1, 2147483646);
                }
            }

            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    const target = mutation.target;
                    if (target.classList.contains('Window') || target.classList.contains('Panel') || target.classList.contains('Terminal')) {
                        ensureOnTop(target);
                    }
                });
            });

            document.addEventListener('DOMContentLoaded', function() {
                const elements = document.querySelectorAll('.Window, .Panel, .Terminal');
                elements.forEach(el => {
                    observer.observe(el, { attributes: true, attributeFilter: ['class', 'style'] });
                });
            });
        })();


        //.Panel

        (function() {
            let isDragging = false;
            let currentPanel = null;
            let offsetX = 0;
            let offsetY = 0;

            function clampPosition(x, y, element) {
                const rect = element.getBoundingClientRect();
                const maxX = window.innerWidth - rect.width;
                const maxY = window.innerHeight - rect.height;
                return {
                    x: Math.max(0, Math.min(x, maxX)),
                    y: Math.max(0, Math.min(y, maxY))
                };
            }

            document.addEventListener('mousedown', function(e) {
                const panel = e.target.closest('.Panel');
                if (panel) {
                    currentPanel = panel;
                    isDragging = true;
                    const rect = currentPanel.getBoundingClientRect();
                    offsetX = e.clientX - rect.left;
                    offsetY = e.clientY - rect.top;
                    currentPanel.style.cursor = 'grabbing';
                }
            });

            document.addEventListener('mousemove', function(e) {
                if (isDragging && currentPanel) {
                    const newX = e.clientX - offsetX;
                    const newY = e.clientY - offsetY;
                    const clamped = clampPosition(newX, newY, currentPanel);
                    currentPanel.style.left = clamped.x + 'px';
                    currentPanel.style.top = clamped.y + 'px';
                }
            });

            document.addEventListener('mouseup', function() {
                if (currentPanel) {
                    currentPanel.style.cursor = '';
                }
                isDragging = false;
                currentPanel = null;
            });

            // Touch support
            document.addEventListener('touchstart', function(e) {
                const panel = e.target.closest('.Panel');
                if (panel) {
                    currentPanel = panel;
                    isDragging = true;
                    const rect = currentPanel.getBoundingClientRect();
                    const touch = e.touches[0];
                    offsetX = touch.clientX - rect.left;
                    offsetY = touch.clientY - rect.top;
                }
            });

            document.addEventListener('touchmove', function(e) {
                if (isDragging && currentPanel) {
                    const touch = e.touches[0];
                    const newX = touch.clientX - offsetX;
                    const newY = touch.clientY - offsetY;
                    const clamped = clampPosition(newX, newY, currentPanel);
                    currentPanel.style.left = clamped.x + 'px';
                    currentPanel.style.top = clamped.y + 'px';
                    e.preventDefault();
                }
            }, { passive: false });

            document.addEventListener('touchend', function() {
                isDragging = false;
                currentPanel = null;
            });
        })();


        //.Terminal

        (function() {
            let isDragging = false;
            let currentTerminal = null;
            let offsetX = 0;
            let offsetY = 0;

            function clampPosition(x, y, element) {
                const rect = element.getBoundingClientRect();
                const maxX = window.innerWidth - rect.width;
                const maxY = window.innerHeight - rect.height;
                return {
                    x: Math.max(0, Math.min(x, maxX)),
                    y: Math.max(0, Math.min(y, maxY))
                };
            }

            document.addEventListener('mousedown', function(e) {
                const terminal = e.target.closest('.Terminal');
                if (terminal && !e.target.closest('.Terminal_Manipulation') && !e.target.closest('.Content') && !window.terminalScrolling) {
                    currentTerminal = terminal;
                    isDragging = true;
                    const rect = currentTerminal.getBoundingClientRect();
                    offsetX = e.clientX - rect.left;
                    offsetY = e.clientY - rect.top;
                    currentTerminal.style.cursor = 'grabbing';
                }
            });

            document.addEventListener('mousemove', function(e) {
                if (isDragging && currentTerminal) {
                    const newX = e.clientX - offsetX;
                    const newY = e.clientY - offsetY;
                    const clamped = clampPosition(newX, newY, currentTerminal);
                    currentTerminal.style.left = clamped.x + 'px';
                    currentTerminal.style.top = clamped.y + 'px';
                }
            });

            document.addEventListener('mouseup', function() {
                if (currentTerminal) {
                    currentTerminal.style.cursor = '';
                }
                isDragging = false;
                currentTerminal = null;
            });

            // Touch support
            document.addEventListener('touchstart', function(e) {
                const terminal = e.target.closest('.Terminal');
                if (terminal && !e.target.closest('.Terminal_Manipulation') && !e.target.closest('.Content') && !window.terminalScrolling) {
                    currentTerminal = terminal;
                    isDragging = true;
                    const rect = currentTerminal.getBoundingClientRect();
                    const touch = e.touches[0];
                    offsetX = touch.clientX - rect.left;
                    offsetY = touch.clientY - rect.top;
                }
            });

            document.addEventListener('touchmove', function(e) {
                if (isDragging && currentTerminal) {
                    const touch = e.touches[0];
                    const newX = touch.clientX - offsetX;
                    const newY = touch.clientY - offsetY;
                    const clamped = clampPosition(newX, newY, currentTerminal);
                    currentTerminal.style.left = clamped.x + 'px';
                    currentTerminal.style.top = clamped.y + 'px';
                    e.preventDefault();
                }
            }, { passive: false });

            document.addEventListener('touchend', function() {
                isDragging = false;
                currentTerminal = null;
            });
        })();
        


        //Snapping system.

        // Snapping system - snap windows to 10px grid

        //.Window
        (function() {
            const SNAP_SIZE = 10;

            function snapToGrid(value) {
                return Math.round(value / SNAP_SIZE) * SNAP_SIZE;
            }

            // Override mouseup to snap position
            document.addEventListener('mouseup', function(e) {
                const windows = document.querySelectorAll('.Window');
                windows.forEach(win => {
                    const rect = win.getBoundingClientRect();
                    win.style.left = snapToGrid(rect.left) + 'px';
                    win.style.top = snapToGrid(rect.top) + 'px';
                });
            });

            // Override touchend to snap position
            document.addEventListener('touchend', function(e) {
                const windows = document.querySelectorAll('.Window');
                windows.forEach(win => {
                    const rect = win.getBoundingClientRect();
                    win.style.left = snapToGrid(rect.left) + 'px';
                    win.style.top = snapToGrid(rect.top) + 'px';
                });
            });
        })();

        //.Panel

        (function() {
            const SNAP_SIZE = 10;

            function snapToGrid(value) {
                return Math.round(value / SNAP_SIZE) * SNAP_SIZE;
            }

            document.addEventListener('mouseup', function(e) {
                const panels = document.querySelectorAll('.Panel');
                panels.forEach(panel => {
                    const rect = panel.getBoundingClientRect();
                    panel.style.left = snapToGrid(rect.left) + 'px';
                    panel.style.top = snapToGrid(rect.top) + 'px';
                });
            });

            document.addEventListener('touchend', function(e) {
                const panels = document.querySelectorAll('.Panel');
                panels.forEach(panel => {
                    const rect = panel.getBoundingClientRect();
                    panel.style.left = snapToGrid(rect.left) + 'px';
                    panel.style.top = snapToGrid(rect.top) + 'px';
                });
            });
        })();

        //.Terminal

        (function() {
            const SNAP_SIZE = 10;

            function snapToGrid(value) {
                return Math.round(value / SNAP_SIZE) * SNAP_SIZE;
            }

            document.addEventListener('mouseup', function(e) {
                const terminals = document.querySelectorAll('.Terminal');
                terminals.forEach(terminal => {
                    const rect = terminal.getBoundingClientRect();
                    terminal.style.left = snapToGrid(rect.left) + 'px';
                    terminal.style.top = snapToGrid(rect.top) + 'px';
                });
            });

            document.addEventListener('touchend', function(e) {
                const terminals = document.querySelectorAll('.Terminal');
                terminals.forEach(terminal => {
                    const rect = terminal.getBoundingClientRect();
                    terminal.style.left = snapToGrid(rect.left) + 'px';
                    terminal.style.top = snapToGrid(rect.top) + 'px';
                });
            });
        })();
        
        // NEW UNIFIED Z-INDEX MANAGEMENT SYSTEM
        
        //Set default position for windows and panels when they open
        (function() {
            let highestZIndex = 10000; // Higher starting z-index to ensure windows are on top
            
            // Function to set default position for elements
            function setDefaultPosition(element) {
                if (element.classList.contains('Window') || element.classList.contains('Panel')) {
                    const currentTop = element.style.top;
                    const currentLeft = element.style.left;
                    
                    // Only set position if not already positioned or at default
                    const needsPositioning = 
                        (!currentTop || currentTop === 'auto' || currentTop === '') ||
                        (!currentLeft || currentLeft === 'auto' || currentLeft === '') ||
                        (currentTop === '0px' && currentLeft === '0px'); // Reset from browser default
                    
                    if (needsPositioning) {
                        element.style.top = '10px';
                        element.style.left = '10px';
                    }
                    
                    // Also set position property to absolute if not already
                    const currentPosition = window.getComputedStyle(element).position;
                    if (currentPosition !== 'absolute' && currentPosition !== 'fixed') {
                        element.style.position = 'absolute';
                    }
                }
            }
            
            // Simple function to bring window to front without heavy observation
            function bringToFront(element) {
                if (element.classList.contains('Window') || element.classList.contains('Panel') || element.classList.contains('Terminal')) {
                    highestZIndex++;
                    element.style.zIndex = highestZIndex;
                    
                    // Set default position if not already positioned
                    setDefaultPosition(element);
                }
            }
            
            // Auto-position elements when they become visible
            function setupAutoPositioning() {
                function syncVisibilityState(element) {
                    const isVisible = window.getComputedStyle(element).display !== 'none';
                    const wasVisible = !!element._wasVisible;

                    // Hidden -> visible transition: bring to front
                    if (isVisible && !wasVisible) {
                        bringToFront(element);
                    } else if (isVisible) {
                        // Keep visible elements correctly positioned without changing z-order
                        setDefaultPosition(element);
                    }

                    element._wasVisible = isVisible;
                }

                // Set up MutationObserver to watch for style changes
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                            const element = mutation.target;
                            if (element.classList.contains('Window') || element.classList.contains('Panel') || element.classList.contains('Terminal')) {
                                syncVisibilityState(element);
                            }
                        }
                    });
                });
                
                // Observe all existing windows, panels, and terminals
                const allElements = document.querySelectorAll('.Window, .Panel, .Terminal');
                allElements.forEach(el => {
                    el._wasVisible = window.getComputedStyle(el).display !== 'none';
                    observer.observe(el, { attributes: true, attributeFilter: ['style'] });
                    
                    // Also set position immediately if already visible
                    if (el._wasVisible) {
                        setDefaultPosition(el);
                    }
                });
                
                // Set up observer for dynamically added elements
                const documentObserver = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        mutation.addedNodes.forEach((node) => {
                            if (node.nodeType === 1) { // Element node
                                if (node.classList && (node.classList.contains('Window') || node.classList.contains('Panel') || node.classList.contains('Terminal'))) {
                                    node._wasVisible = window.getComputedStyle(node).display !== 'none';
                                    // New window/panel/terminal added, observe it
                                    observer.observe(node, { attributes: true, attributeFilter: ['style'] });
                                    
                                    // Set position if visible
                                    if (node._wasVisible) {
                                        bringToFront(node);
                                    }
                                }
                            }
                        });
                    });
                });
                
                // Observe document for new elements
                documentObserver.observe(document.body, { childList: true, subtree: true });
            }
            
            // Initialize auto-positioning when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', setupAutoPositioning);
            } else {
                setupAutoPositioning();
            }
            
            // Aggressive positioning - run every 2 seconds to ensure all elements are positioned
            setInterval(() => {
                const allElements = document.querySelectorAll('.Window, .Panel, .Terminal');
                allElements.forEach(el => {
                    const display = window.getComputedStyle(el).display;
                    if (display !== 'none') {
                        const currentTop = el.style.top;
                        const currentLeft = el.style.left;
                        
                        // Only force position if not positioned or at browser default (0px, 0px)
                        const needsPositioning = 
                            (!currentTop || currentTop === 'auto' || currentTop === '') ||
                            (!currentLeft || currentLeft === 'auto' || currentLeft === '') ||
                            (currentTop === '0px' && currentLeft === '0px');
                        
                        if (needsPositioning) {
                            setDefaultPosition(el);
                        }
                    }
                });
            }, 2000);
            
            // Immediate positioning on button clicks
            document.addEventListener('click', function(e) {
                // Check if this is a button that opens a window
                if (e.target.id === 'Start_Menu_Panel_Login') {
                    const loginWindow = document.getElementById('Login_Terminal');
                    if (loginWindow) {
                        setTimeout(() => {
                            setDefaultPosition(loginWindow);
                        }, 50);
                    }
                }
                
                if (e.target.id === 'Start_Menu_Panel_Signup' || 
                    (e.target.closest && e.target.closest('#Start_Menu_Panel_Signup'))) {
                    const signupWindow = document.getElementById('Sign-Up_Terminal');
                    if (signupWindow) {
                        setTimeout(() => {
                            setDefaultPosition(signupWindow);
                        }, 50);
                    }
                }
                
                if (e.target.id === 'Start_Button') {
                    const startMenu = document.getElementById('Start_Menu_Panel');
                    if (startMenu) {
                        setTimeout(() => {
                            setDefaultPosition(startMenu);
                        }, 50);
                    }
                }
            });
            
            // Bring any interacted window/panel/terminal to front (header or content)
            document.addEventListener('mousedown', function(e) {
                const windowElement = e.target.closest('.Window') || e.target.closest('.Panel') || e.target.closest('.Terminal');
                if (windowElement) {
                    bringToFront(windowElement);
                }
            });

            document.addEventListener('touchstart', function(e) {
                const windowElement = e.target.closest('.Window') || e.target.closest('.Panel') || e.target.closest('.Terminal');
                if (windowElement) {
                    bringToFront(windowElement);
                }
            });
            
            // Apply z-index to windows when they're opened via button clicks
            document.addEventListener('click', function(e) {
                if (e.target.id === 'Start_Menu_Panel_Login') {
                    const loginWindow = document.getElementById('Login_Terminal');
                    if (loginWindow) {
                        setTimeout(() => {
                            bringToFront(loginWindow);
                        }, 10);
                    }
                }
                if (e.target.id === 'Start_Menu_Panel_Signup' || 
                    (e.target.closest && e.target.closest('#Start_Menu_Panel_Signup'))) {
                    const signupWindow = document.getElementById('Sign-Up_Terminal');
                    if (signupWindow) {
                        setTimeout(() => {
                            bringToFront(signupWindow);
                        }, 10);
                    }
                }
            });
            
            // Also bring start menu to front when opened
            document.addEventListener('click', function(e) {
                if (e.target.id === 'Start_Button') {
                    const startMenu = document.getElementById('Start_Menu_Panel');
                    if (startMenu) {
                        setTimeout(() => {
                            bringToFront(startMenu);
                        }, 10);
                    }
                }
            });
        })();

    </Script>

    <script aria-label="Terminal_Manager - Script">
        (function() {
            'use strict';
            
            // Terminal Manager - Centralized terminal management
            // ALWAYS VIEW AND FOLLOW THE DEFAULT PROMPT: //User: 
            const TerminalManager = {
                terminals: new Map(),
                defaultPrompt: '//User: ',
                isAndroid: /android/i.test(navigator.userAgent || ''),
                
                // Register a new terminal
                registerTerminal: function(terminalId, config) {
                    const terminal = {
                        id: terminalId,
                        element: document.getElementById(terminalId),
                        prompt: config.prompt || this.defaultPrompt,
                        transcript: '',
                        currentInput: '',
                        rendering: false,
                        welcomeStarted: false,
                        customCommands: config.customCommands || {},
                        welcomeMessages: config.welcomeMessages || [],
                        ...config
                    };
                    
                    this.terminals.set(terminalId, terminal);
                    this.initializeTerminal(terminal);
                    return terminal;
                },
                
                // Initialize terminal DOM and events
                initializeTerminal: function(terminal) {
                    if (!terminal.element) return;
                    
                    // Create terminal nodes
                    const terminalTextNode = document.createTextNode('');
                    const terminalCursorNode = document.createElement('span');
                    terminalCursorNode.className = 'terminal-cursor';
                    terminalCursorNode.style.animation = 'terminal-blink 0.5s step-end infinite';
                    
                    terminal.element.innerHTML = '';
                    terminal.element.appendChild(terminalTextNode);
                    terminal.element.appendChild(terminalCursorNode);
                    
                    // Store references
                    terminal.textNode = terminalTextNode;
                    terminal.cursorNode = terminalCursorNode;
                    
                    // Enable Android keyboard auto-capitalization
                    this.enableAutoCapitalization(terminal);
                    
                    // Setup event listeners
                    this.setupEventListeners(terminal);
                    
                    // Start welcome messages if configured
                    if (terminal.welcomeMessages.length > 0) {
                        this.setupWelcomeMessages(terminal);
                    }
                    
                    // Initial render
                    this.render(terminal);
                },
                
                // Enable Android keyboard auto-capitalization
                enableAutoCapitalization: function(terminal) {
                    const element = terminal.element;
                    
                    // Add input method attributes for better mobile keyboard support
                    element.setAttribute('contenteditable', 'true');
                    element.setAttribute('autocapitalize', 'sentences'); // Android auto-capitalization
                    element.setAttribute('autocomplete', 'off');
                    element.setAttribute('autocorrect', 'off');
                    element.setAttribute('spellcheck', 'false');
                    
                    // Set CSS properties for better mobile experience
                    element.style.webkitTapHighlightColor = 'transparent';
                    element.style.webkitUserSelect = 'text';
                    element.style.userSelect = 'text';
                    
                    // Android-specific optimizations
                    if (this.isAndroid) {
                        // Use CSS variable for font size
                        element.style.fontSize = 'var(--Main_Font_Size)';
                        element.style.lineHeight = '1.4';
                        element.style.padding = '8px';
                        element.style.minHeight = '44px'; // Minimum touch target size
                        
                        // Disable long-press menu
                        element.style.webkitTouchCallout = 'none';
                        element.style.webkitUserSelect = 'text';
                        element.style.userSelect = 'text';
                        
                        // Enable better touch scrolling
                        element.style.webkitOverflowScrolling = 'touch';
                        element.style.overflowY = 'auto';
                    }
                    
                    // Initialize capitalization state
                    terminal.shouldCapitalizeNext = true;
                    terminal.lastCharWasSentenceEnd = false;
                },
                
                // Setup event listeners for terminal
                setupEventListeners: function(terminal) {
                    const element = terminal.element;
                    
                    // Physical keyboard events
                    element.addEventListener('keydown', (e) => this.handleKeyDown(e, terminal));
                    element.addEventListener('beforeinput', (e) => this.handleBeforeInput(e, terminal));
                    element.addEventListener('input', () => this.handleInput(terminal));
                    element.addEventListener('pointerup', () => this.handlePointerUp(terminal));
                    element.addEventListener('focus', () => this.handleFocus(terminal));
                    element.addEventListener('blur', () => this.handleBlur(terminal));
                    
                    // Touch scrolling support
                    element.addEventListener('touchstart', (e) => this.handleTouchStart(e, terminal), { passive: false });
                    element.addEventListener('touchmove', (e) => this.handleTouchMove(e, terminal), { passive: false });
                    element.addEventListener('touchend', (e) => this.handleTouchEnd(e, terminal), { passive: false });
                    
                    // Android-specific handling
                    if (this.isAndroid) {
                        element.addEventListener('compositionstart', () => terminal.rendering = true);
                        element.addEventListener('compositionend', async () => {
                            terminal.rendering = false;
                            await this.syncInputFromDom(terminal);
                        });
                        element.addEventListener('textInput', (e) => {
                            if (e.data && e.data !== '\n') {
                                if (/[ \u00A0]/.test(e.data)) {
                                    e.preventDefault();
                                    return;
                                }
                                // Apply capitalization for Android input
                                let textToAdd = e.data;
                                if (!terminal.passwordMode && terminal.shouldCapitalizeNext && e.data.match(/^[a-z]/)) {
                                    textToAdd = e.data.charAt(0).toUpperCase() + e.data.slice(1);
                                    terminal.shouldCapitalizeNext = false;
                                }
                                
                                terminal.currentInput += textToAdd;
                                this.updateCapitalizationState(terminal, textToAdd, false);
                                this.render(terminal);
                                e.preventDefault();
                            }
                        });
                    }
                },
                
                // Handle keyboard input
                handleKeyDown: async function(e, terminal) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        const toRun = terminal.currentInput;
                        terminal.currentInput = '';
                        await this.executeCommand(toRun, terminal);
                        terminal.shouldScrollToBottom = true;
                        this.render(terminal);
                        
                        // Reset capitalization state after command execution
                        terminal.shouldCapitalizeNext = true;
                        terminal.lastCharWasSentenceEnd = false;
                        return;
                    }
                    
                    if (e.key === 'Backspace') {
                        e.preventDefault();
                        if (terminal.currentInput.length > 0) {
                            const removedChar = terminal.currentInput.slice(-1);
                            terminal.currentInput = terminal.currentInput.slice(0, -1);
                            
                            // Update capitalization state after backspace
                            this.updateCapitalizationState(terminal, removedChar, true);
                            this.render(terminal);
                        }
                        return;
                    }
                    
                    // Block space key - no spaces allowed in terminals
                    if (e.key === ' ' || e.key === 'Spacebar' || e.code === 'Space') {
                        e.preventDefault();
                        return;
                    }
                    
                    // Handle punctuation that ends sentences
                    if (e.key === '.' || e.key === '!' || e.key === '?') {
                        e.preventDefault();
                        terminal.currentInput += e.key;
                        if (!terminal.passwordMode) {
                            terminal.lastCharWasSentenceEnd = true;
                            terminal.shouldCapitalizeNext = true;
                        }
                        this.render(terminal);
                        return;
                    }
                    
                    // Handle regular character input
                    if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
                        e.preventDefault();
                        
                        // Apply capitalization if needed
                        let charToAdd = e.key;
                        if (!terminal.passwordMode && terminal.shouldCapitalizeNext && e.key.match(/[a-z]/)) {
                            charToAdd = e.key.toUpperCase();
                            terminal.shouldCapitalizeNext = false;
                        }
                        
                        terminal.currentInput += charToAdd;
                        this.updateCapitalizationState(terminal, charToAdd, false);
                        this.render(terminal);
                        return;
                    }
                },
                
                // Update capitalization state based on input changes
                updateCapitalizationState: function(terminal, char, isBackspace = false) {
                    if (terminal.passwordMode) {
                        terminal.shouldCapitalizeNext = false;
                        terminal.lastCharWasSentenceEnd = false;
                        return;
                    }

                    if (isBackspace) {
                        // Check if we removed a sentence-ending punctuation
                        if (char === '.' || char === '!' || char === '?') {
                            terminal.lastCharWasSentenceEnd = false;
                            terminal.shouldCapitalizeNext = false;
                        }
                        // Check if we're now at the beginning or after a sentence end
                        if (terminal.currentInput.length === 0) {
                            terminal.shouldCapitalizeNext = true;
                        } else if (terminal.currentInput.slice(-1) === '.' || 
                                  terminal.currentInput.slice(-1) === '!' || 
                                  terminal.currentInput.slice(-1) === '?') {
                            terminal.lastCharWasSentenceEnd = true;
                            terminal.shouldCapitalizeNext = true;
                        }
                    } else {
                        // Regular input - update based on the character added
                        if (char === '.' || char === '!' || char === '?') {
                            terminal.lastCharWasSentenceEnd = true;
                            terminal.shouldCapitalizeNext = true;
                        } else if (char === ' ') {
                            terminal.lastCharWasSentenceEnd = false;
                        } else {
                            terminal.lastCharWasSentenceEnd = false;
                            terminal.shouldCapitalizeNext = false;
                        }
                    }
                },
                
                // Apply smart capitalization to input
                applyCapitalization: function(terminal, input) {
                    if (!terminal.shouldCapitalizeNext || input.length === 0) {
                        return input;
                    }
                    
                    // Capitalize the first character
                    const firstChar = input.charAt(0).toUpperCase();
                    const rest = input.slice(1);
                    return firstChar + rest;
                },
                
                // Handle before input events
                handleBeforeInput: function(e, terminal) {
                    if (e.inputType === 'insertLineBreak') {
                        e.preventDefault();
                        const toRun = terminal.currentInput;
                        terminal.currentInput = '';
                        (async () => {
                            await this.executeCommand(toRun, terminal);
                            terminal.shouldScrollToBottom = true;
                            this.render(terminal);
                        })();
                        return;
                    }
                    
                    // Block space input on all platforms including Android
                    if (e.data && /[ \u00A0]/.test(e.data)) {
                        e.preventDefault();
                        return;
                    }
                },
                
                // Handle input events
                handleInput: async function(terminal) {
                    if (terminal.rendering) return;
                    await this.syncInputFromDom(terminal);
                },
                
                // Handle pointer up events
                handlePointerUp: function(terminal) {
                    setTimeout(() => this.placeCaretAtEnd(terminal), 0);
                    document.querySelectorAll('.terminal-cursor').forEach(cursor => {
                        cursor.classList.add('hidden');
                    });
                    if (terminal.cursorNode) {
                        terminal.cursorNode.classList.remove('hidden');
                    }
                },
                
                // Handle focus events
                handleFocus: function(terminal) {
                    document.querySelectorAll('.terminal-cursor').forEach(cursor => {
                        cursor.classList.add('hidden');
                    });
                    if (terminal.cursorNode) {
                        terminal.cursorNode.classList.remove('hidden');
                    }
                },
                
                // Handle blur events
                handleBlur: function(terminal) {
                    if (terminal.cursorNode) {
                        terminal.cursorNode.classList.add('hidden');
                    }
                },
                
                // Touch scrolling support
                handleTouchStart: function(e, terminal) {
                    // Store initial touch position and scroll state
                    terminal.touchStartY = e.touches[0].clientY;
                    terminal.touchStartX = e.touches[0].clientX;
                    terminal.startScrollTop = terminal.element.scrollTop;
                    terminal.isTouchScrolling = false;
                    
                    // Android-specific touch handling
                    if (this.isAndroid) {
                        // Set touch-action for better scrolling
                        terminal.element.style.touchAction = 'pan-y';
                        
                        // Allow native focus/tap so Android keyboard can open
                        terminal.element.style.webkitUserSelect = 'text';
                        terminal.element.style.userSelect = 'text';

                        terminal.touchStartTime = Date.now();
                    }
                    
                    // Find the parent window element
                    terminal.parentWindow = terminal.element.closest('.Window');
                    
                    // If inside a draggable window, prevent window drag during terminal touch
                    if (terminal.parentWindow && !this.isAndroid) {
                        terminal.parentWindow.style.pointerEvents = 'none';
                    }
                },
                
                handleTouchMove: function(e, terminal) {
                    // Prevent default only if we're scrolling vertically
                    const touchY = e.touches[0].clientY;
                    const touchX = e.touches[0].clientX;
                    const deltaY = terminal.touchStartY - touchY;
                    const deltaX = terminal.touchStartX - touchX;
                    
                    // Check if this is a vertical scroll gesture
                    if (Math.abs(deltaY) > Math.abs(deltaX) && Math.abs(deltaY) > 10) {
                        terminal.isTouchScrolling = true;
                        e.preventDefault();
                        e.stopPropagation();
                        
                        // Calculate new scroll position
                        const newScrollTop = terminal.startScrollTop + deltaY;
                        const maxScroll = terminal.element.scrollHeight - terminal.element.clientHeight;
                        
                        // Apply scroll bounds
                        if (newScrollTop >= 0 && newScrollTop <= maxScroll) {
                            terminal.element.scrollTop = newScrollTop;
                        }
                    }
                },
                
                handleTouchEnd: function(e, terminal) {
                    // Restore window pointer events
                    if (terminal.parentWindow) {
                        terminal.parentWindow.style.pointerEvents = '';
                    }
                    
                    // Android-specific touch end handling
                    if (this.isAndroid) {
                        // Re-enable text selection after touch
                        setTimeout(() => {
                            terminal.element.style.webkitUserSelect = 'text';
                            terminal.element.style.userSelect = 'text';
                        }, 100);
                        
                        // Check if this was a tap (short touch duration)
                        const touchDuration = Date.now() - terminal.touchStartTime;
                        if (touchDuration < 200 && Math.abs(terminal.touchStartY - e.changedTouches[0].clientY) < 10) {
                            // This was a tap - place cursor at end
                            this.placeCaretAtEnd(terminal);
                        }
                    }
                    
                    // Reset touch scrolling state
                    terminal.isTouchScrolling = false;
                    terminal.touchStartTime = 0;
                    
                    // Clear global flag to allow window dragging again
                    window.terminalScrolling = false;
                    
                    // Reset touch tracking variables
                    terminal.touchStartY = null;
                    terminal.touchStartX = null;
                    terminal.startScrollTop = null;
                    terminal.parentWindow = null;
                },
                
                // Execute command
                executeCommand: async function(raw, terminal) {
                    const input = (raw || '').trim();
                    
                    // Check if user is in a process and pressed Enter twice (empty input)
                    if (!input && this.isInProcess(terminal)) {
                        // Check if this is the second consecutive empty Enter
                        if (terminal.lastEmptyInput && (Date.now() - terminal.lastEmptyInput) < 1000) {
                            // Save current process state
                            terminal.savedProcessState = this.captureProcessState(terminal);
                            
                            // Escape to command prompt
                            this.escapeToCommandPrompt(terminal);
                            return;
                        } else {
                            // First empty Enter, record timestamp
                            terminal.lastEmptyInput = Date.now();
                            this.render(terminal);
                            return;
                        }
                    }
                    
                    // Reset empty input tracking if non-empty input
                    if (input) {
                        terminal.lastEmptyInput = null;
                    }
                    
                    if (!input) {
                        this.render(terminal);
                        return;
                    }
                    
                    // Check if user is trying to execute commands while in process
                    if (this.isInProcess(terminal)) {
                        const commandName = input.split(/\s+/)[0].toLowerCase();
                        
                        // Allow Reset and Clear commands during input processes
                        if (commandName === 'reset') {
                            // In signup password step, reset should return to DOB entry
                            if (terminal.awaitingSignupPassword) {
                                terminal.awaitingSignupFirstName = false;
                                terminal.awaitingSignupLastName = false;
                                terminal.awaitingSignupDOB = true;
                                terminal.awaitingSignupPassword = false;
                                terminal.signupDOB = null;
                                terminal.signupPassword = null;
                                terminal.prompt = 'Day (DD): ';
                                terminal.passwordMode = false;
                                terminal.currentInput = '';
                                terminal.shouldCapitalizeNext = true;
                                terminal.lastCharWasSentenceEnd = false;
                                this.printLine('Reset to DOB entry.', terminal);
                                this.render(terminal);
                                return;
                            }

                            // Check if we're in the first question of a data set
                            const isFirstQuestion = 
                                terminal.awaitingFirstName || 
                                terminal.awaitingSignupFirstName ||
                                terminal.awaitingForgotFirstName;
                            
                            if (isFirstQuestion) {
                                // Save current state before clearing
                                this.saveState(terminal);
                                
                                // Clear the current data set completely
                                this.clearCurrentDataSet(terminal);
                                
                                // Try to restore the previous data set (if available)
                                if (terminal.stateHistory && terminal.stateHistory.length > 1) {
                                    // Remove the current state we just saved
                                    terminal.stateHistory.pop();
                                    
                                    // Restore the previous state
                                    if (this.restoreState(terminal, -1)) {
                                        this.printLine('Current data set cleared. Returned to previous data set.', terminal);
                                        this.printLine('Use "undo" command to restore the cleared data set if needed.', terminal);
                                    } else {
                                        this.printLine('Current data set cleared. No previous data set available.', terminal);
                                    }
                                } else {
                                    // No previous state, just show cleared state
                                    this.printLine('Current data set cleared. No previous data set to restore.', terminal);
                                }
                            } else {
                                this.printLine('Reset command executed. Use specific reset commands during input processes.', terminal);
                            }
                            this.render(terminal);
                            return;
                        }
                        
                        if (commandName === 'clear') {
                            // Save current state
                            this.saveState(terminal);
                            
                            // Clear the current process and return to default prompt
                            this.clearCurrentDataSet(terminal);
                            
                            this.printLine('Process cleared. Returned to default prompt.', terminal);
                            this.render(terminal);
                            return;
                        }
                        
                        // If in forgot password process, let the process handle commands through its own logic
                        // Don't block commands here as they're handled in the executeCommand overrides
                    }
                    
                    // Add prompt to transcript for normal commands
                    terminal.transcript += terminal.prompt + raw + '\n';
                    
                    const parts = input.split(/\s+/);
                    const commandName = parts[0].toLowerCase();
                    const args = parts.slice(1);
                    
                    // Check custom commands first
                    if (terminal.customCommands[commandName]) {
                        try {
                            await terminal.customCommands[commandName].run({
                                args: args,
                                print: (text) => this.printLine(text, terminal),
                                clear: () => { terminal.transcript = ''; },
                                terminalData: terminal,
                                terminal: terminal.element,
                                activeInput: terminal.element
                            });
                        } catch (err) {
                            this.printLine('Custom command error: ' + (err && err.message ? err.message : err), terminal);
                        }
                    } else {
                        // Default command handling
                        await this.handleDefaultCommand(commandName, args, terminal);
                    }

                    this.render(terminal);
                },
                
                // Handle default commands
                handleDefaultCommand: async function(commandName, args, terminal) {
                    switch (commandName) {
                        case 'clear':
                            this.printLine('', terminal);
                            this.printLine('Clearing terminal...', terminal);
                            this.printLine('', terminal);
                            
                            // Clear terminal data
                            this.clearTerminalData(terminal);
                            
                            // Reset terminal state to defaults
                            terminal.prompt = this.defaultPrompt;
                            terminal.passwordMode = false;
                            terminal.currentInput = '';
                            terminal.previousPrompt = null;
                            
                            // Clear any custom state variables that might exist
                            // Login state
                            terminal.awaitingFirstName = false;
                            terminal.awaitingLastName = false;
                            terminal.awaitingPassword = false;
                            terminal.firstName = null;
                            terminal.lastName = null;
                            terminal.password = null;
                            
                            // Signup state
                            terminal.awaitingSignupFirstName = false;
                            terminal.awaitingSignupLastName = false;
                            terminal.awaitingSignupDOB = false;
                            terminal.awaitingSignupPassword = false;
                            terminal.signupFirstName = null;
                            terminal.signupLastName = null;
                            terminal.signupDOB = null;
                            terminal.signupPassword = null;
                            
                            // Forgot state
                            terminal.awaitingForgotFirstName = false;
                            terminal.awaitingForgotLastName = false;
                            terminal.awaitingForgotDOB = false;
                            terminal.forgotFirstName = null;
                            terminal.forgotLastName = null;
                            terminal.forgotDOB = null;
                            
                            // Re-show welcome messages if they exist
                            if (terminal.welcomeMessages && terminal.welcomeMessages.length > 0) {
                                terminal.welcomeStarted = false;
                                this.setupWelcomeMessages(terminal);
                            }

                            break;
                        case 'reset':

                            // Check if we're in the first question of a data set
                            const isFirstQuestion = 
                                terminal.awaitingFirstName || 
                                terminal.awaitingSignupFirstName ||
                                terminal.awaitingForgotFirstName;
                            
                            if (isFirstQuestion && this.isInProcess(terminal)) {
                                // Save current state before clearing
                                this.saveState(terminal);
                                
                                // Clear the current data set completely
                                this.clearCurrentDataSet(terminal);
                                
                                // Try to restore the previous data set (if available)
                                if (terminal.stateHistory && terminal.stateHistory.length > 1) {
                                    // Remove the current state we just saved
                                    terminal.stateHistory.pop();
                                    
                                    // Restore the previous state
                                    if (this.restoreState(terminal, -1)) {
                                        this.printLine('Current data set cleared. Returned to previous data set.', terminal);
                                    } else {
                                        this.printLine('Current data set cleared. No previous data set available.', terminal);
                                    }
                                } else {
                                    // No previous state, just show cleared state
                                    this.printLine('Current data set cleared. No previous data set to restore.', terminal);
                                }
                            } else {
                                this.printLine('Reset command executed. Use specific reset commands during input processes.', terminal);
                            }
                            this.render(terminal);
                            break;
                        case 'exit':

                            if (this.isInProcess(terminal)) {

                                // Save current state
                                this.saveState(terminal);
                                
                                // Clear the current process and return to default prompt
                                this.clearCurrentDataSet(terminal);
                                
                                this.printLine('Process exited. Returned to default prompt.', terminal);
                            } else {
                                this.printLine('Exit command executed. No active process to exit.', terminal);
                            }
                            this.render(terminal);
                            break;
                        case 'close':
                            // Clear terminal data before closing
                            this.clearTerminalData(terminal);
                            if (terminal.windowId) {
                                document.getElementById(terminal.windowId).style.display = 'none';
                            }
                            break;
                        default:
                            this.printLine('Unknown command: ' + commandName, terminal);
                            break;
                    }
                },
                
                // Display command list in column format
                displayCommandList: function(terminal, commands) {
                    this.printLine('Commands', terminal);
                    this.printLine('', terminal);
                    
                    commands.forEach(command => {
                        const paddedName = command.name.padEnd(8, ' ');
                        this.printLine(paddedName + ' - ' + command.description, terminal);
                    });
                    
                    this.printLine('', terminal);
                },
                
                // Get login-specific command list
                getLoginCommandList: function() {
                    return [
                        { name: 'Login', description: 'Start login process' },
                        { name: 'Signup', description: 'Start sign-up process' },
                        { name: 'Forgot', description: 'Forgot password' },
                        { name: 'Change', description: 'Change password' },
                        { name: 'Clear', description: 'Clear terminal' },
                        { name: 'Reset', description: 'Fix mistakes' },
                        { name: 'License', description: 'View license' },
                        { name: 'Exit', description: 'Exits out of a process' },
                        { name: 'Close', description: 'Close window' }
                    ];
                },
                
                // Get signup-specific command list
                getSignupCommandList: function() {
                    return [
                        { name: 'Signup', description: 'Start sign-up process' },
                        { name: 'Clear', description: 'Clear terminal' },
                        { name: 'Reset', description: 'Fix mistakes' },
                        { name: 'Exit', description: 'Exits out of a process' },
                        { name: 'Close', description: 'Close window' }
                    ];
                },
                
                // Get forgot-specific command list
                getForgotCommandList: function() {
                    return [
                        { name: 'Forgot', description: 'Start password recovery process' },
                        { name: 'Clear', description: 'Clear terminal' },
                        { name: 'Reset', description: 'Fix mistakes' },
                        { name: 'Exit', description: 'Exits out of a process' },
                        { name: 'Close', description: 'Close window' }
                    ];
                },
                
                // Get change-specific command list
                getChangeCommandList: function() {
                    return [
                        { name: 'Change', description: 'Start change password process' },
                        { name: 'Clear', description: 'Clear terminal' },
                        { name: 'Reset', description: 'Fix mistakes' },
                        { name: 'Exit', description: 'Exits out of a process' },
                        { name: 'Close', description: 'Close window' }
                    ];
                },
                
                // Get default command list for terminals
                getDefaultCommandList: function() {
                    return [
                        { name: 'Clear', description: 'Clear terminal' },
                        { name: 'Reset', description: 'Fix mistakes' },
                        { name: 'Exit', description: 'Exits out of a process' },
                        { name: 'Close', description: 'Close window' }
                    ];
                },
                
                // Save current terminal state for undo/restore functionality
                saveState: function(terminal) {
                    const state = {
                        timestamp: Date.now(),
                        prompt: terminal.prompt,
                        passwordMode: terminal.passwordMode,
                        currentInput: terminal.currentInput,
                        transcript: terminal.transcript,
                        welcomeStarted: terminal.welcomeStarted
                    };
                    
                    // Save all process flags
                    const processFlags = [
                        'awaitingFirstName', 'awaitingLastName', 'awaitingPassword',
                        'awaitingSignupFirstName', 'awaitingSignupLastName', 
                        'awaitingSignupDOB', 'awaitingSignupPassword',
                        'awaitingForgotFirstName', 'awaitingForgotLastName', 'awaitingForgotDOB'
                    ];
                    
                    processFlags.forEach(flag => {
                        state[flag] = terminal[flag];
                    });
                    
                    // Save all data variables
                    const dataVars = [
                        'firstName', 'lastName', 'password',
                        'signupFirstName', 'signupLastName', 
                        'signupDOB', 'signupPassword',
                        'forgotFirstName', 'forgotLastName', 'forgotDOB'
                    ];
                    
                    dataVars.forEach(variable => {
                        state[variable] = terminal[variable];
                    });
                    
                    // Store in terminal's state history
                    if (!terminal.stateHistory) {
                        terminal.stateHistory = [];
                    }
                    terminal.stateHistory.push(state);
                    
                    // Keep only last 5 states to prevent memory issues
                    if (terminal.stateHistory.length > 5) {
                        terminal.stateHistory.shift();
                    }
                },
                
                // Restore terminal state from history
                restoreState: function(terminal, stateIndex = -1) {
                    if (!terminal.stateHistory || terminal.stateHistory.length === 0) {
                        return false;
                    }
                    
                    const state = stateIndex === -1 ? 
                        terminal.stateHistory[terminal.stateHistory.length - 1] : 
                        terminal.stateHistory[stateIndex];
                        
                    if (!state) {
                        return false;
                    }
                    
                    // Restore basic terminal properties
                    terminal.prompt = state.prompt;
                    terminal.passwordMode = state.passwordMode;
                    terminal.currentInput = state.currentInput;
                    terminal.transcript = state.transcript;
                    terminal.welcomeStarted = state.welcomeStarted;
                    
                    // Restore all process flags
                    const processFlags = [
                        'awaitingFirstName', 'awaitingLastName', 'awaitingPassword',
                        'awaitingSignupFirstName', 'awaitingSignupLastName', 
                        'awaitingSignupDOB', 'awaitingSignupPassword',
                        'awaitingForgotFirstName', 'awaitingForgotLastName', 'awaitingForgotDOB'
                    ];
                    
                    processFlags.forEach(flag => {
                        terminal[flag] = state[flag];
                    });
                    
                    // Restore all data variables
                    const dataVars = [
                        'firstName', 'lastName', 'password',
                        'signupFirstName', 'signupLastName', 
                        'signupDOB', 'signupPassword',
                        'forgotFirstName', 'forgotLastName', 'forgotDOB'
                    ];
                    
                    dataVars.forEach(variable => {
                        terminal[variable] = state[variable];
                    });
                    
                    this.render(terminal);
                    return true;
                },
                
                // Clear current data set but keep state history
                clearCurrentDataSet: function(terminal) {

                    // Clear process flags
                    const processFlags = [
                        'awaitingFirstName', 'awaitingLastName', 'awaitingPassword',
                        'awaitingSignupFirstName', 'awaitingSignupLastName', 
                        'awaitingSignupDOB', 'awaitingSignupPassword',
                        'awaitingForgotFirstName', 'awaitingForgotLastName', 'awaitingForgotDOB'
                    ];
                    
                    processFlags.forEach(flag => {
                        terminal[flag] = false;
                    });
                    
                    // Clear data variables
                    const dataVars = [
                        'firstName', 'lastName', 'password',
                        'signupFirstName', 'signupLastName', 
                        'signupDOB', 'signupPassword',
                        'forgotFirstName', 'forgotLastName', 'forgotDOB'
                    ];
                    
                    dataVars.forEach(variable => {
                        terminal[variable] = null;
                    });
                    
                    // Reset to default prompt
                    terminal.prompt = this.defaultPrompt;
                    terminal.passwordMode = false;
                    terminal.currentInput = '';
                },
                
                // Clear terminal data
                clearTerminalData: function(terminal) {
                    terminal.transcript = '';
                    terminal.currentInput = '';
                    terminal.welcomeStarted = false;
                    // Clear the terminal display immediately
                    if (terminal.textNode) {
                        terminal.textNode.nodeValue = '';
                    }
                    // Don't render here to prevent welcome messages from showing immediately
                },
                
                // Print line to terminal
                printLine: function(text, terminal) {
                    const line = text == null ? '' : String(text);
                    terminal.transcript += line + '\n';
                    terminal.shouldScrollToBottom = true;
                    this.triggerPromptJump(terminal);
                    this.render(terminal);
                },

                // Trigger prompt jump animation
                triggerPromptJump: function(terminal) {
                    if (!terminal || !terminal.cursorNode) {
                        return;
                    }
                    terminal.cursorNode.classList.remove('prompt-jump');
                    void terminal.cursorNode.offsetWidth;
                    terminal.cursorNode.classList.add('prompt-jump');
                },
                
                // Render terminal
                render: function(terminal) {
                    terminal.rendering = true;
                    const scrollTop = terminal.element.scrollTop;
                    const wasAtBottom = (terminal.element.scrollHeight - terminal.element.scrollTop - terminal.element.clientHeight) < 5;
                    terminal.element.setAttribute('autocapitalize', terminal.passwordMode ? 'off' : 'sentences');
                    const prompt = terminal.prompt;
                    let display = terminal.currentInput;
                    const isSignupPasswordInput = terminal.id === 'Sign-Up_Terminal_Content_Terminal_Main_Text' && terminal.awaitingSignupPassword;
                    
                    // Handle password masking
                    if (terminal.passwordMode && display && !isSignupPasswordInput) {
                        display = '*'.repeat(display.length);
                    }
                    
                    // Add line spacing between transcript and prompt
                    const spacing = terminal.transcript && terminal.transcript.trim() ? '\n' : '';
                    terminal.textNode.nodeValue = terminal.transcript + spacing + prompt + display;
                    
                    if (terminal.cursorNode.parentNode !== terminal.element) {
                        terminal.element.appendChild(terminal.cursorNode);
                    }
                    
                    // Only auto-scroll to bottom if user was already at bottom or if shouldScrollToBottom is true
                    if (wasAtBottom || terminal.shouldScrollToBottom) {
                        terminal.element.scrollTop = terminal.element.scrollHeight;
                    } else {
                        // Preserve user's scroll position when they scrolled up
                        terminal.element.scrollTop = scrollTop;
                    }
                    
                    terminal.shouldScrollToBottom = false;
                    this.placeCaretAtEnd(terminal);
                    setTimeout(() => { terminal.rendering = false; }, 0);
                },
                
                // Place caret at end
                placeCaretAtEnd: function(terminal) {
                    try {
                        // Android-specific caret placement
                        if (this.isAndroid) {
                            // Force focus and caret placement for Android
                            terminal.element.focus({ preventScroll: true });
                            
                            // Use a more reliable method for Android
                            const range = document.createRange();
                            range.selectNodeContents(terminal.element);
                            range.collapse(false);
                            
                            const sel = window.getSelection();
                            sel.removeAllRanges();
                            sel.addRange(range);
                            
                            // Don't force scroll to bottom - preserve user's scroll position
                            
                            return;
                        }
                        
                        terminal.element.focus({ preventScroll: true });
                    } catch (err) {
                        terminal.element.focus();
                    }
                    
                    const sel = window.getSelection();
                    if (!sel) {
                        return;
                    }
                    const range = document.createRange();
                    range.selectNodeContents(terminal.element);
                    range.collapse(false);
                    sel.removeAllRanges();
                    sel.addRange(range);
                },
                
                // Sync input from DOM
                syncInputFromDom: async function(terminal) {
                    const full = terminal.element.textContent || '';
                    const prompt = terminal.prompt;
                    const baseText = terminal.transcript + prompt;
                     
                    if (full.slice(0, baseText.length) !== baseText) {
                        this.render(terminal);
                        return;
                    }
                    
                    const domInput = full.slice(baseText.length).replace(/\r/g, '');
                    const sanitizedInput = domInput.replace(/[ \u00A0]/g, '');

                    if (sanitizedInput !== domInput) {
                        terminal.currentInput = sanitizedInput;
                        this.render(terminal);
                        return;
                    }
                    
                    if (sanitizedInput.indexOf('\n') !== -1) {
                        const firstLine = sanitizedInput.split('\n')[0];
                        terminal.currentInput = firstLine;
                        const toRun = terminal.currentInput;
                        terminal.currentInput = '';
                        this.executeCommand(toRun, terminal);
                        terminal.shouldScrollToBottom = true;
                        this.render(terminal);
                        return;
                    }
                    
                    let nextInput = sanitizedInput;
                    if (!terminal.passwordMode && terminal.shouldCapitalizeNext && nextInput.length > 0 && /^[a-z]/.test(nextInput.charAt(0))) {
                        nextInput = nextInput.charAt(0).toUpperCase() + nextInput.slice(1);
                        terminal.shouldCapitalizeNext = false;
                    }

                    terminal.currentInput = nextInput;
                },
                
                // Setup welcome messages
                setupWelcomeMessages: function(terminal) {
                    const startWelcomeMessages = () => {
                        // Only start welcome messages if terminal is truly empty (fresh state)
                        if (!terminal.welcomeStarted && terminal.transcript === '') {
                            terminal.welcomeStarted = true;
                            terminal.welcomeMessages.forEach((message, index) => {
                                setTimeout(() => {
                                    if (typeof message === 'function') {
                                        message(terminal);
                                    } else {
                                        this.printLine(message, terminal);
                                    }
                                }, (index + 1) * 1000);
                            });
                        }
                    };
                    
                    // Check if window is already visible
                    const windowElement = terminal.windowId ? document.getElementById(terminal.windowId) : null;
                    if (windowElement) {
                        // Check current display state
                        const currentDisplay = windowElement.style.display;
                        const computedStyle = getComputedStyle(windowElement);
                        const isVisible = currentDisplay !== 'none' && computedStyle.display !== 'none';
                        
                        if (isVisible) {
                            // Window is already visible, start animation after a short delay if terminal is empty
                            setTimeout(startWelcomeMessages, 100);
                        }
                        
                        // Watch for style changes (reopen)
                        const observer = new MutationObserver((mutations) => {
                            mutations.forEach((mutation) => {
                                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                                    if (windowElement.style.display !== 'none') {
                                        // Small delay to ensure window is fully visible
                                        setTimeout(startWelcomeMessages, 100);
                                    }
                                }
                            });
                        });
                        observer.observe(windowElement, { attributes: true });
                    }
                },
                
                // Get terminal by ID
                getTerminal: function(terminalId) {
                    return this.terminals.get(terminalId);
                },
                
                // SHA-256 hash function
                sha256: async function(input) {
                    try {
                        const encoder = new TextEncoder();
                        const data = encoder.encode(input);
                        const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                        const hashArray = Array.from(new Uint8Array(hashBuffer));
                        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();
                    } catch (error) {
                        console.error('SHA-256 error:', error);
                        throw new Error('SHA-256 hashing not available: ' + error.message);
                    }
                },
                
                // Add custom command to terminal
                addCommand: function(terminalId, name, handler, description) {
                    const terminal = this.terminals.get(terminalId);
                    if (terminal && name && typeof handler === 'function') {
                        terminal.customCommands[String(name).toLowerCase()] = {
                            run: handler,
                            desc: description || 'Custom command'
                        };
                    }
                },
                
                // Remove command from terminal
                removeCommand: function(terminalId, name) {
                    const terminal = this.terminals.get(terminalId);
                    if (terminal && name) {
                        delete terminal.customCommands[String(name).toLowerCase()];
                    }
                },
                
                // Clear all terminal data
                clearAllTerminalData: function() {
                    this.terminals.forEach((terminal, terminalId) => {
                        this.clearTerminalData(terminal);
                    });
                },
                
                // Check if terminal is in a process (login/signup/forgot)
                isInProcess: function(terminal) {
                    return (
                        // Login process states
                        terminal.awaitingFirstName ||
                        terminal.awaitingLastName ||
                        terminal.awaitingPassword ||
                        // Signup process states
                        terminal.awaitingSignupFirstName ||
                        terminal.awaitingSignupLastName ||
                        terminal.awaitingSignupDOB ||
                        terminal.awaitingSignupPassword ||
                        // Forgot password process states
                        terminal.awaitingForgotFirstName ||
                        terminal.awaitingForgotLastName ||
                        terminal.awaitingForgotDOB ||
                        // Any other custom process states
                        (terminal.customProcessState && terminal.customProcessState.active)
                    );
                },
                
                // Capture current process state for undo
                captureProcessState: function(terminal) {
                    const state = {
                        timestamp: Date.now(),
                        terminalId: terminal.id,
                        prompt: terminal.prompt,
                        passwordMode: terminal.passwordMode,
                        currentInput: terminal.currentInput,
                        previousPrompt: terminal.previousPrompt
                    };
                    
                    // Capture login process state
                    if (terminal.awaitingFirstName || terminal.awaitingLastName || terminal.awaitingPassword) {
                        state.processType = 'login';
                        state.awaitingFirstName = terminal.awaitingFirstName;
                        state.awaitingLastName = terminal.awaitingLastName;
                        state.awaitingPassword = terminal.awaitingPassword;
                        state.firstName = terminal.firstName;
                        state.lastName = terminal.lastName;
                        state.password = terminal.password;
                    }
                    
                    // Capture signup process state
                    if (terminal.awaitingSignupFirstName || terminal.awaitingSignupLastName || 
                        terminal.awaitingSignupDOB || terminal.awaitingSignupPassword) {
                        state.processType = 'signup';
                        state.awaitingSignupFirstName = terminal.awaitingSignupFirstName;
                        state.awaitingSignupLastName = terminal.awaitingSignupLastName;
                        state.awaitingSignupDOB = terminal.awaitingSignupDOB;
                        state.awaitingSignupPassword = terminal.awaitingSignupPassword;
                        state.signupFirstName = terminal.signupFirstName;
                        state.signupLastName = terminal.signupLastName;
                        state.signupDOB = terminal.signupDOB;
                        state.signupPassword = terminal.signupPassword;
                    }
                    
                    // Capture any custom process state
                    if (terminal.customProcessState) {
                        state.customProcessState = { ...terminal.customProcessState };
                    }
                    
                    return state;
                },
                
                // Escape from process to command prompt
                escapeToCommandPrompt: function(terminal) {

                    // Add escape message to transcript
                    this.printLine('', terminal);
                    this.printLine('Press Enter twice to escape to command prompt', terminal);
                    this.printLine('', terminal);
                    
                    // Reset to command prompt state
                    terminal.prompt = this.defaultPrompt;
                    terminal.passwordMode = false;
                    terminal.currentInput = '';
                    terminal.previousPrompt = null;
                    
                    // Clear process flags but keep data
                    const processFlags = [
                        'awaitingFirstName', 'awaitingLastName', 'awaitingPassword',
                        'awaitingSignupFirstName', 'awaitingSignupLastName', 
                        'awaitingSignupDOB', 'awaitingSignupPassword'
                    ];
                    
                    processFlags.forEach(flag => {
                        if (terminal[flag]) {
                            terminal[flag] = false;
                        }
                    });
                    
                    // Clear custom process state
                    if (terminal.customProcessState) {
                        terminal.customProcessState.active = false;
                    }
                },
                
                // Restore process state from saved state
                restoreProcessState: function(terminal) {
                    if (!terminal.savedProcessState) {
                        this.printLine('No process state to restore.', terminal);
                        return false;
                    }
                    
                    const state = terminal.savedProcessState;

                    // Restore basic terminal state
                    terminal.prompt = state.prompt;
                    terminal.passwordMode = state.passwordMode;
                    terminal.currentInput = state.currentInput || '';
                    terminal.previousPrompt = state.previousPrompt;
                    
                    // Restore login process state
                    if (state.processType === 'login') {
                        terminal.awaitingFirstName = state.awaitingFirstName;
                        terminal.awaitingLastName = state.awaitingLastName;
                        terminal.awaitingPassword = state.awaitingPassword;
                        terminal.firstName = state.firstName;
                        terminal.lastName = state.lastName;
                        terminal.password = state.password;
                        
                        this.printLine('', terminal);
                        this.printLine('Returning to login process...', terminal);
                        this.printLine('', terminal);
                    }
                    
                    // Restore signup process state
                    if (state.processType === 'signup') {
                        terminal.awaitingSignupFirstName = state.awaitingSignupFirstName;
                        terminal.awaitingSignupLastName = state.awaitingSignupLastName;
                        terminal.awaitingSignupDOB = state.awaitingSignupDOB;
                        terminal.awaitingSignupPassword = state.awaitingSignupPassword;
                        terminal.signupFirstName = state.signupFirstName;
                        terminal.signupLastName = state.signupLastName;
                        terminal.signupDOB = state.signupDOB;
                        terminal.signupPassword = state.signupPassword;
                        
                        this.printLine('', terminal);
                        this.printLine('Returning to signup process...', terminal);
                        this.printLine('', terminal);
                    }
                    
                    // Restore custom process state
                    if (state.customProcessState) {
                        terminal.customProcessState = { ...state.customProcessState };
                        terminal.customProcessState.active = true;
                    }
                    
                    // Clear saved state after restoration
                    terminal.savedProcessState = null;

                    return true;
                },
                
                // Step back one step in the current process
                stepBackInProcess: function(terminal) {

                    // Login process step back
                    if (terminal.awaitingPassword) {
                        terminal.awaitingPassword = false;
                        terminal.awaitingLastName = true;
                        terminal.password = null;
                        terminal.prompt = 'Last Name: ';
                        terminal.passwordMode = false;
                        terminal.currentInput = '';
                        this.printLine('', terminal);
                        this.printLine('Stepped back to last name entry.', terminal);
                        this.playBeep();
                        this.render(terminal);
                        return true;
                    }
                    
                    if (terminal.awaitingLastName) {
                        terminal.awaitingLastName = false;
                        terminal.awaitingFirstName = true;
                        terminal.lastName = null;
                        terminal.prompt = 'First Name: ';
                        terminal.currentInput = '';
                        this.printLine('', terminal);
                        this.printLine('Stepped back to first name entry.', terminal);
                        this.playBeep();
                        this.render(terminal);
                        return true;
                    }
                    
                    // Signup process step back
                    if (terminal.awaitingSignupPassword) {
                        terminal.awaitingSignupPassword = false;
                        terminal.awaitingSignupDOB = true;
                        terminal.signupPassword = null;
                        terminal.prompt = 'Year (YYYY): ';
                        terminal.passwordMode = false;
                        terminal.currentInput = '';
                        this.printLine('', terminal);
                        this.printLine('Stepped back to year entry.', terminal);
                        this.playBeep();
                        this.render(terminal);
                        return true;
                    }
                    
                    if (terminal.awaitingSignupDOB && terminal.signupDOB && terminal.signupDOB.month) {
                        terminal.awaitingSignupDOB = true;
                        terminal.signupDOB.year = null;
                        terminal.prompt = 'Month (MM): ';
                        terminal.currentInput = '';
                        this.printLine('', terminal);
                        this.printLine('Stepped back to month entry.', terminal);
                        this.playBeep();
                        this.render(terminal);
                        return true;
                    }
                    
                    if (terminal.awaitingSignupDOB && terminal.signupDOB && terminal.signupDOB.day) {
                        terminal.awaitingSignupDOB = true;
                        terminal.signupDOB.month = null;
                        terminal.prompt = 'Day (DD): ';
                        terminal.currentInput = '';
                        this.printLine('', terminal);
                        this.printLine('Stepped back to day entry.', terminal);
                        this.playBeep();
                        this.render(terminal);
                        return true;
                    }
                    
                    if (terminal.awaitingSignupDOB) {
                        terminal.awaitingSignupDOB = false;
                        terminal.awaitingSignupLastName = true;
                        terminal.signupDOB = null;
                        terminal.prompt = 'Last Name: ';
                        terminal.currentInput = '';
                        this.printLine('', terminal);
                        this.printLine('Stepped back to last name entry.', terminal);
                        this.playBeep();
                        this.render(terminal);
                        return true;
                    }
                    
                    if (terminal.awaitingSignupLastName) {
                        terminal.awaitingSignupLastName = false;
                        terminal.awaitingSignupFirstName = true;
                        terminal.signupLastName = null;
                        terminal.prompt = 'First Name: ';
                        terminal.currentInput = '';
                        this.printLine('', terminal);
                        this.printLine('Stepped back to first name entry.', terminal);
                        this.playBeep();
                        this.render(terminal);
                        return true;
                    }

                    return false;
                }
            };
            
            // Make TerminalManager globally available
            window.TerminalManager = TerminalManager;
            
        })();
    </script>
    <script src="database.js"></script>
</head>
<body>

    <!--Book_Mark: Cursor-->    
    
    <div class="Cursor">
        <div class="Cursor_Build">
            <span id="Cursor_Pointer"></span>
        </div>
        <style>
            #Cursor_Pointer {
                position: absolute;
                width: 5px;
                height: 5px;
                border-radius: 50%;
                background-color: rgb(255, 255, 255);
                z-index: 100;
            }
        </style>
        <Script>
            document.addEventListener('DOMContentLoaded', function() {
                const cursorPointer = document.getElementById('Cursor_Pointer');
                
                // Hide default cursor on all elements
                document.documentElement.style.cursor = 'none';
                document.body.style.cursor = 'none';
                
                // Apply cursor:none to all elements
                const style = document.createElement('style');
                style.textContent = '* { cursor: none !important; }';
                document.head.appendChild(style);
                
                // Make cursor non-interactive so clicks pass through
                cursorPointer.style.pointerEvents = 'none';
                cursorPointer.style.zIndex = '2147483647';
                cursorPointer.style.position = 'fixed';
                
                document.addEventListener('mousemove', function(e) {
                    cursorPointer.style.left = e.clientX + 'px';
                    cursorPointer.style.top = e.clientY + 'px';
                });
                
                // Hide custom cursor when mouse leaves window
                document.addEventListener('mouseleave', function() {
                    cursorPointer.style.display = 'none';
                });
                
                // Show custom cursor when mouse enters window
                document.addEventListener('mouseenter', function() {
                    cursorPointer.style.display = 'block';
                });
                
                // Touch support - cursor follows touch point during drag
                document.addEventListener('touchstart', function(e) {
                    const touch = e.touches[0];
                    cursorPointer.style.left = touch.clientX + 'px';
                    cursorPointer.style.top = touch.clientY + 'px';
                    cursorPointer.style.display = 'block';
                });
                
                document.addEventListener('touchmove', function(e) {
                    const touch = e.touches[0];
                    cursorPointer.style.left = touch.clientX + 'px';
                    cursorPointer.style.top = touch.clientY + 'px';
                });
                
                document.addEventListener('touchend', function() {
                    cursorPointer.style.display = 'flex';
                });
            });
            
        </Script>
    </div>

    
    

    <div class="Login">
        <div class="Login_Build">

            <!--Book_Mark: Wallpaper_Slide_Show-->
            <div class="Wallpaper_Slide_Show">
                <div class="Wallpapers_List">
                    <img src="/Images/Wallpaper/3d-render-gradient-1080x2160-9736.jpg" alt="">
                </div>

                <style aria-label="Wallpaper_Slide_Show - Style">
                    .Wallpaper_Slide_Show > .Wallpapers_List > img {
                        height: 100dvh;
                        width: 100dvw;
                        background-size: contain;
                        display: none;
                    }
                </style>
            </div>

            <!--Book_Mark: Start_Button-->

            <div class="Start_Button">
                <button id="Start_Button">[ Start ]</button>

                <style aria-label="Login_Build_Start_Button - Style">
                    .Start_Button {
                        position: absolute;
                        bottom: 20px;
                    }
                    #Start_Button { 
                        font-size: 14px;
                        color: rgb(255, 255, 255);
                    }
                </style>
                <script aria-label="Start_Button - Script">
                    document.getElementById('Start_Button').addEventListener('click', function() {
                        // Request fullscreen (with robust browser fallbacks)
                        const requestFullscreen = (element) => {
                            if (!element) {
                                return false;
                            }
                            const request = element.requestFullscreen || element.webkitRequestFullscreen || element.msRequestFullscreen;
                            if (!request) {
                                return false;
                            }
                            try {
                                const maybePromise = request.call(element);
                                if (maybePromise && typeof maybePromise.catch === 'function') {
                                    maybePromise.catch(() => {});
                                }
                                return true;
                            } catch (error) {
                                return false;
                            }
                        };

                        if (!requestFullscreen(document.documentElement)) {
                            requestFullscreen(document.body);
                        }
                        // Show the start menu panel
                        document.getElementById('Start_Menu_Panel').style.display = 'flex';
                        // Hide the start button
                        document.getElementById('Start_Button').style.display = 'none';
                    });
                </script>
            </div>

            <!--Book_Mark: Login_Builld - Start_Menu_Panel-->
            <div class="Panel" id="Start_Menu_Panel">
                <p class="Title">Start Menu</p>
                <button class="Panel_Close" id="Start_Menu_Panel_Close"></button>
                <div class="Start_Menu_Panel_Buttons">
                    <button id="Start_Menu_Panel_Login">[ Login ]</button>
                    <button>[ Character Index ]</button>
                    <button>[ About Vista D-Net ]</button>
                    <button>[ D-Wifi Connections ]</button>
                    <button>[ Reset to original OS ]</button>
                    <button>[ Load from disk ]</button>
                    <button>[ Themes ]</button>
                    <button>[ Author ]</button>
                    <button id="Start_Menu_Panel_Exit">[ Exit Page ]</button>

                    <style aria-label="Start_Menu_Panel_Buttons - Style">

                    </style>

                    <script aria-label="Start_Menu_Panel_Buttons - Script">

                        document.getElementById('Start_Menu_Panel_Login').addEventListener('click', function() {
                            document.getElementById('Login_Terminal').style.display = 'flex';
                            const loginTerminal = TerminalManager.getTerminal('Login_Terminal_Content_Terminal_Main_Text');
                            if (loginTerminal) {
                                loginTerminal.shouldScrollToBottom = true;
                                TerminalManager.render(loginTerminal);
                            }
                        });

                        document.getElementById('Start_Menu_Panel_Exit').addEventListener('click', function() {
                            if (document.exitFullscreen) {
                                document.exitFullscreen();
                            } else if (document.webkitExitFullscreen) {
                                document.webkitExitFullscreen();
                            } else if (document.msExitFullscreen) {
                                document.msExitFullscreen();
                            }
                        });

                    </script>
                </div>
                
                        
                <!--Book_Mark: Login_Builld - Start_Menu_Panel - Style-->
                <style aria-label="Start_Menu_Panel - Style">
                    #Start_Menu_Panel {
                        width: 180px;
                        height: 260px;
                        display: flex;
                        flex-direction: column;
                        align-items: flex-start;
                        gap: 10px;
                        text-indent: 10px;
                        display: none;
                    }

                    #Start_Menu_Panel > .Start_Menu_Panel_Buttons {
                        position: absolute;
                        top: 60px;
                        left: 10px;
                        width: auto;
                        height: auto;
                        display: flex;
                        align-items: flex-start;
                        flex-direction: column;
                        gap: 10px;
                    }
                </style>

                <script aria-label="Start_Menu_Panel - Script">
                    document.getElementById('Start_Menu_Panel_Close').addEventListener('click', function() {

                        document.getElementById('Start_Menu_Panel').style.display = 'none';
                    });

                    document.getElementById('Start_Menu_Panel_Close').addEventListener('click', function() {
                        document.getElementById('Start_Button').style.display = 'flex';
                    });
                </script>
            </div>

            

            <!--Book_Mark: Login_Build - Login_Terminal-->
            <div class="Terminal" id="Login_Terminal">
                <div class="Header" id="Login_Terminal_Header">
                    <p class="Title">Login</p>
                    <div class="Terminal_Manipulation">
                        <button class="Terminal_Minimize" id="Login_Terminal_Minimize"></button>
                        <button class="Terminal_Maximize" id="Login_Terminal_Maximize"></button>
                        <button class="Terminal_Close" id="Login_Terminal_Close"></button>
                    </div>
                </div>
                <div class="Content" id="Login_Terminal_Content_Terminal">
                    <p id="Login_Terminal_Content_Terminal_Main_Text" class="terminal" contenteditable="true" tabindex="0" spellcheck="false" autocorrect="off" autocapitalize="off" autocomplete="off"></p>

                    <!--Book_Mark: Login_Build - Login_Terminal_Content_Terminal - Style-->
                    <style aria-label="Login_Terminal_Content_Terminal - Style"> 
                        #Login_Terminal_Content_Terminal {
                            background-color: var(--Terminal_Background_Color);
                            
                        }

                        #Login_Terminal_Content_Terminal_Main_Text {
                            position: absolute;  
                            top: 10px;
                            left: 10px;                     
                            width: calc(100% - 20px);
                            height: calc(100% - 20px);
                            color: var(--Terminal_Text_Color);
                            overflow: auto;
                            overflow-anchor: none;
                            white-space: pre-wrap;
                            line-height: 1.45;
                            outline: none;
                            -webkit-user-modify: read-write-plaintext-only;
                            -webkit-tap-highlight-color: transparent;
                            -webkit-touch-callout: none;
                            -webkit-user-select: text;
                            user-select: text;
                        }
                        
                        @media (max-width: 768px) {
                            #Login_Terminal_Content_Terminal_Main_Text {
                                font-size: 11px;
                                line-height: 1.4;
                            }
                        }
                    </style>

                    <script aria-label="Login_Terminal_Content_Terminal - Script">
                        document.addEventListener('DOMContentLoaded', function() {
                            // Register the login terminal with TerminalManager
                            const terminal = TerminalManager.registerTerminal('Login_Terminal_Content_Terminal_Main_Text', {
                                windowId: 'Login_Terminal',
                                prompt: TerminalManager.defaultPrompt, // Use default prompt from manager
                                welcomeMessages: [
                                    'Welcome to Vista-D-NET Corporation 2026. Under the open source license - MIT 2025 dtron7th. Build on with MIT',
                                    '',
                                    'AI Agent - Kimi K2.5.',
                                    '',
                                    function(terminal) {
                                        TerminalManager.displayCommandList(terminal, TerminalManager.getLoginCommandList());
                                    },
                                    ''
                                ]
                            });
                            
                            // Add custom commands
                            TerminalManager.addCommand('Login_Terminal_Content_Terminal_Main_Text', 'login', function(context) {
                                const loginTerminal = context.terminalData;
                                if (!loginTerminal) return;
                                
                                loginTerminal.awaitingFirstName = true;
                                loginTerminal.previousPrompt = loginTerminal.prompt;
                                loginTerminal.prompt = 'First Name: ';
                                loginTerminal.currentInput = '';
                                context.print('');
                                context.print('=== Login to account. (Hash is case sensitive) ===');
                                context.print('');
                                context.print('Enter your first name:');
                            }, 'Start login process');

                            TerminalManager.addCommand('Login_Terminal_Content_Terminal_Main_Text', 'clear', function(context) {
                                const loginTerminal = context.terminalData;
                                if (!loginTerminal) {
                                    return;
                                }
                                
                                // Reset all login state variables
                                loginTerminal.awaitingFirstName = false;
                                loginTerminal.awaitingLastName = false;
                                loginTerminal.awaitingPassword = false;
                                loginTerminal.firstName = null;
                                loginTerminal.lastName = null;
                                loginTerminal.password = null;
                                loginTerminal.previousPrompt = null;
                                loginTerminal.prompt = TerminalManager.defaultPrompt;
                                loginTerminal.passwordMode = false;
                                loginTerminal.currentInput = '';
                                
                                // Clear the terminal display
                                context.clear();
                                
                                // Show welcome messages again
                                context.print('Welcome to Vista-D-NET Corporation 2026. Under the open source license - MIT 2025 dtron7th. Build on with MIT');
                                context.print('');
                                context.print('AI Agent - Kimi K2.5.');
                                context.print('');
                                TerminalManager.displayCommandList(loginTerminal, TerminalManager.getLoginCommandList());
                                context.print('');
                                context.print('Login process cleared. Ready to start fresh.');
                                context.print('');
                            }, 'Clear login process and start over');
                            
                            // Add Reset command
                            TerminalManager.addCommand('Login_Terminal_Content_Terminal_Main_Text', 'reset', function(context) {
                                const loginTerminal = context.terminalData;
                                if (!loginTerminal) {
                                    return;
                                }
                                
                                context.print('Reset command available during information process input to reset data entry.');
                                context.print('Type [Login] to start the login process.');
                                context.print('');
                            }, 'Reset command for login process');
                            
                            // Terminal-scoped input handling
                            if (!TerminalManager._loginFirstNamePatched) {
                                const originalExecuteCommand = TerminalManager.executeCommand.bind(TerminalManager);
                                TerminalManager.executeCommand = async function(raw, terminalData) {
                                    
                                    // ==================== FIRST NAME INPUT ====================
                                    if (terminalData && terminalData.id === 'Login_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingFirstName) {
                                        const firstName = (raw || '').trim();
                                        
                                        // Check if user wants to clear
                                        if (firstName.toLowerCase() === 'clear') {
                                            // Reset all login state variables
                                            terminalData.awaitingFirstName = true;
                                            terminalData.awaitingLastName = false;
                                            terminalData.awaitingPassword = false;
                                            terminalData.firstName = null;
                                            terminalData.lastName = null;
                                            terminalData.password = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Clearing login process...', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to reset
                                        if (firstName.toLowerCase() === 'reset') {
                                            // Reset to first name (same as clear for first name)
                                            terminalData.awaitingFirstName = true;
                                            terminalData.awaitingLastName = false;
                                            terminalData.awaitingPassword = false;
                                            terminalData.firstName = null;
                                            terminalData.lastName = null;
                                            terminalData.password = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Reset to first name entry:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to exit
                                        if (firstName.toLowerCase() === 'exit') {
                                            
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!firstName) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        terminalData.transcript += terminalData.prompt + firstName + '\n';
                                        terminalData.awaitingFirstName = false;
                                        terminalData.firstName = firstName;
                                        terminalData.awaitingLastName = true;
                                        terminalData.prompt = 'Last Name: ';
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        this.printLine('', terminalData);
                                        this.printLine('Enter your last name:', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }

                                    // ==================== LAST NAME INPUT ====================
                                    if (terminalData && terminalData.id === 'Login_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingLastName) {
                                        const lastName = (raw || '').trim();
                                        
                                        // Check if user wants to clear
                                        if (lastName.toLowerCase() === 'clear') {
                                            // Reset all login state variables
                                            terminalData.awaitingFirstName = true;
                                            terminalData.awaitingLastName = false;
                                            terminalData.awaitingPassword = false;
                                            terminalData.firstName = null;
                                            terminalData.lastName = null;
                                            terminalData.password = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Clearing login process...', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to reset
                                        if (lastName.toLowerCase() === 'reset') {
                                            // Reset to first name
                                            terminalData.awaitingFirstName = true;
                                            terminalData.awaitingLastName = false;
                                            terminalData.awaitingPassword = false;
                                            terminalData.firstName = null;
                                            terminalData.lastName = null;
                                            terminalData.password = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Reset to first name entry:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to exit
                                        if (lastName.toLowerCase() === 'exit') {
                                            
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!lastName) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        terminalData.transcript += terminalData.prompt + lastName + '\n';
                                        terminalData.awaitingLastName = false;
                                        terminalData.lastName = lastName;
                                        terminalData.awaitingPassword = true;
                                        terminalData.prompt = 'Password: ';
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = false;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        terminalData.passwordMode = true;
                                        this.printLine('', terminalData);
                                        this.printLine('Enter your password:', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }

                                    // ==================== PASSWORD INPUT ====================
                                    if (terminalData && terminalData.id === 'Login_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingPassword) {
                                        const password = (raw || '').trim();

                                        // Check if user wants to undo
                                        if (password.toLowerCase() === 'undo') {
                                            // Step back to last name input
                                            terminalData.awaitingFirstName = false;
                                            terminalData.awaitingLastName = true;
                                            terminalData.awaitingPassword = false;
                                            terminalData.prompt = 'Last Name: ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.passwordMode = false;
                                            terminalData.password = null;

                                            this.printLine('', terminalData);
                                            this.printLine('Stepped back to last name entry:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to clear
                                        if (password.toLowerCase() === 'clear') {
                                            // Reset all login state variables
                                            terminalData.awaitingFirstName = true;
                                            terminalData.awaitingLastName = false;
                                            terminalData.awaitingPassword = false;
                                            terminalData.firstName = null;
                                            terminalData.lastName = null;
                                            terminalData.password = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Clearing login process...', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to exit
                                        if (password.toLowerCase() === 'exit') {
                                            
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to reset
                                        if (password.toLowerCase() === 'reset') {
                                            
                                            // Reset to first name
                                            terminalData.awaitingFirstName = true;
                                            terminalData.awaitingLastName = false;
                                            terminalData.awaitingPassword = false;
                                            terminalData.firstName = null;
                                            terminalData.lastName = null;
                                            terminalData.password = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Reset to first name entry:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!password) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        // Add masked password to transcript
                                        terminalData.transcript += terminalData.prompt + '*'.repeat(password.length) + '\n';
                                        terminalData.awaitingPassword = false;
                                        terminalData.password = password;
                                        terminalData.passwordMode = false;
                                        terminalData.prompt = 'Password: ';
                                        terminalData.previousPrompt = null;
                                        terminalData.currentInput = '';
                                        this.printLine('', terminalData);
                                        this.printLine('=== Processing Hash ===', terminalData);
                                        
                                        // Keep password prompt during hash processing; reset to default after processing
                                        
                                        // Combine credentials and generate SHA-256
                                        try {
                                            const combined = terminalData.firstName + terminalData.lastName + terminalData.password;
                                            const encoder = new TextEncoder();
                                            const data = encoder.encode(combined);
                                            const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                                            const hashArray = Array.from(new Uint8Array(hashBuffer));
                                            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Primary Account SHA-256 Hash: ' + hashHex, terminalData);
                                            
                                            // Keep password prompt while processing
                                            terminalData.prompt = 'Password: ';
                                            
                                            // Store hash in database
                                            if (window.HashDatabase) {
                                                try {
                                                    const hashId = await window.HashDatabase.storeHash(hashHex, null, 'login');
                                                    this.printLine('', terminalData);
                                                    this.printLine('Hash ID: ' + hashId + ' stored securely', terminalData);
                                                    
                                                    // Keep password prompt while processing
                                                    terminalData.prompt = 'Password: ';
                                                } catch (dbError) {
                                                    this.printLine('', terminalData);
                                                    this.printLine('Warning: Hash storage failed - ' + dbError.message, terminalData);
                                                    
                                                    // Keep password prompt while processing
                                                    terminalData.prompt = 'Password: ';
                                                }
                                            } else {
                                                this.printLine('', terminalData);
                                                this.printLine('Note: Database not initialized', terminalData);
                                                
                                                // Keep password prompt while processing
                                                terminalData.prompt = 'Password: ';
                                            }
                                            
                                        } catch (error) {
                                            this.printLine('Error generating hash: ' + error.message, terminalData);
                                            
                                            // Keep password prompt while processing
                                            terminalData.prompt = 'Password: ';
                                        }
                                        
                                        // Return to default command prompt after hash processing
                                        terminalData.prompt = this.defaultPrompt;
                                        terminalData.previousPrompt = null;
                                        terminalData.passwordMode = false;
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        
                                        this.printLine('', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }

                                    // ==================== FORGOT PASSWORD PROCESS ====================
                                    if (terminalData && terminalData.id === 'Forgot_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingForgotFirstName) {
                                        const firstName = (raw || '').trim();
                                        
                                        // Check for terminal commands first
                                        const commandName = firstName.toLowerCase();
                                        if (commandName === 'reset') {
                                            // Check if we're in the first question of a data set
                                            const isFirstQuestion = terminalData.awaitingForgotFirstName;
                                            
                                            if (isFirstQuestion) {
                                                // Save current state before clearing
                                                this.saveState(terminalData);
                                                
                                                // Clear the current data set completely
                                                this.clearCurrentDataSet(terminalData);
                                                
                                                // Try to restore the previous data set (if available)
                                                if (terminalData.stateHistory && terminalData.stateHistory.length > 1) {
                                                    // Remove the current state we just saved
                                                    terminalData.stateHistory.pop();
                                                    
                                                    // Restore the previous state
                                                    if (this.restoreState(terminalData, -1)) {
                                                        this.printLine('Current data set cleared. Returned to previous data set.', terminalData);
                                                        this.printLine('Use "undo" command to restore the cleared data set if needed.', terminalData);
                                                    } else {
                                                        this.printLine('Current data set cleared. No previous data set available.', terminalData);
                                                    }
                                                } else {
                                                    // No previous state, just show cleared state
                                                    this.printLine('Current data set cleared. No previous data set to restore.', terminalData);
                                                }
                                            } else {
                                                this.printLine('Reset command executed. Use specific reset commands during input processes.', terminalData);
                                            }
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (commandName === 'clear') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process cleared. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (commandName === 'exit') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!firstName) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        terminalData.transcript += terminalData.prompt + firstName + '\n';
                                        terminalData.awaitingForgotFirstName = false;
                                        terminalData.forgotFirstName = firstName;
                                        terminalData.awaitingForgotLastName = true;
                                        terminalData.prompt = 'Last Name: ';
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        this.printLine('', terminalData);
                                        this.printLine('Enter your last name:', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }

                                    // ==================== FORGOT PASSWORD LAST NAME ====================
                                    if (terminalData && terminalData.id === 'Forgot_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingForgotLastName) {
                                        const lastName = (raw || '').trim();
                                        
                                        // Check for terminal commands first
                                        const commandName = lastName.toLowerCase();
                                        if (commandName === 'reset') {
                                            // Reset to first name entry
                                            terminalData.awaitingForgotFirstName = true;
                                            terminalData.awaitingForgotLastName = false;
                                            terminalData.awaitingForgotDOB = false;
                                            terminalData.forgotFirstName = null;
                                            terminalData.forgotLastName = null;
                                            terminalData.forgotDOB = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.prompt = 'First Name: ';

                                            this.printLine('', terminalData);
                                            this.printLine('Reset to first name entry:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }

                                        if (commandName === 'clear') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process cleared. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (commandName === 'exit') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!lastName) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        terminalData.transcript += terminalData.prompt + lastName + '\n';
                                        terminalData.awaitingForgotLastName = false;
                                        terminalData.forgotLastName = lastName;
                                        terminalData.awaitingForgotDOB = true;
                                        terminalData.prompt = 'Day (DD): ';
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        this.printLine('', terminalData);
                                        this.printLine('Enter your date of birth:', terminalData);
                                        this.printLine('Day (numbers only):', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }

                                    // ==================== FORGOT PASSWORD DOB ====================
                                    if (terminalData && terminalData.id === 'Forgot_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingForgotDOB) {
                                        const input = (raw || '').trim();
                                        
                                        // Check for terminal commands first
                                        const commandName = input.toLowerCase();
                                        if (commandName === 'reset') {
                                            const isDayPrompt = (terminalData.prompt || '').trim().startsWith('Day (DD):');

                                            if (isDayPrompt) {
                                                // Reset to first-name entry when reset is executed on day prompt
                                                terminalData.awaitingForgotFirstName = true;
                                                terminalData.awaitingForgotLastName = false;
                                                terminalData.awaitingForgotDOB = false;
                                                terminalData.forgotFirstName = null;
                                                terminalData.forgotLastName = null;
                                                terminalData.forgotDOB = null;
                                                terminalData.prompt = 'First Name: ';
                                            } else {
                                                // Reset DOB entry back to day prompt for month/year
                                                terminalData.awaitingForgotFirstName = false;
                                                terminalData.awaitingForgotLastName = false;
                                                terminalData.awaitingForgotDOB = true;
                                                terminalData.forgotDOB = null;
                                                terminalData.prompt = 'Day (DD): ';
                                            }
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;

                                            this.printLine('', terminalData);
                                            this.printLine(isDayPrompt ? 'Reset to first name entry:' : 'DOB reset. Starting fresh:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }

                                        if (commandName === 'clear') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process cleared. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (commandName === 'exit') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!input) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        // Check if input contains only numbers or is Reset command
                                        if (!/^\d+$/.test(input) && input.toLowerCase() !== 'reset') {
                                            this.printLine('Error: Please enter numbers only or type "Reset" to reset DOB.', terminalData);
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Handle Reset command
                                        if (input.toLowerCase() === 'reset') {
                                            // Reset DOB completely
                                            terminalData.awaitingForgotFirstName = false;
                                            terminalData.awaitingForgotLastName = false;
                                            terminalData.awaitingForgotDOB = true;
                                            terminalData.forgotDOB = null;
                                            terminalData.prompt = 'Day (DD): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('DOB reset. Starting fresh:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }

                                        if (!terminalData.forgotDOB) {
                                            terminalData.forgotDOB = {};
                                        }

                                        if (terminalData.prompt === 'Day (DD): ') {
                                            // Check if input is exactly 2 digits
                                            if (input.length !== 2) {
                                                this.printLine('Error: Day must be exactly 2 digits (e.g., 01, 05, 15).', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            
                                            const day = parseInt(input);
                                            if (day < 1 || day > 31) {
                                                this.printLine('Error: Day must be between 01 and 31.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            terminalData.transcript += terminalData.prompt + input + '\n';
                                            terminalData.forgotDOB.day = input;
                                            terminalData.prompt = 'Month (MM): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            this.printLine('', terminalData);
                                            this.printLine('Month (numbers only):', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                        } else if (terminalData.prompt === 'Month (MM): ') {
                                            // Check if input is exactly 2 digits or is Reset command
                                            if (input.length !== 2 && input.toLowerCase() !== 'reset') {
                                                this.printLine('Error: Month must be exactly 2 digits (e.g., 01, 05, 12) or type "Reset" to reset DOB.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            
                                            // Handle Reset command
                                            if (input.toLowerCase() === 'reset') {
                                                // Reset DOB completely
                                                terminalData.awaitingForgotFirstName = false;
                                                terminalData.awaitingForgotLastName = false;
                                                terminalData.awaitingForgotDOB = true;
                                                terminalData.forgotDOB = null;
                                                terminalData.prompt = 'Day (DD): ';
                                                terminalData.currentInput = '';
                                                terminalData.shouldCapitalizeNext = true;
                                                terminalData.lastCharWasSentenceEnd = false;
                                                
                                                this.printLine('', terminalData);
                                                this.printLine('DOB reset. Starting fresh:', terminalData);
                                                this.playBeep();
                                                this.render(terminalData);
                                                return;
                                            }
                                            const month = parseInt(input);
                                            if (month < 1 || month > 12) {
                                                this.printLine('Error: Month must be between 01 and 12.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            terminalData.transcript += terminalData.prompt + input + '\n';
                                            terminalData.forgotDOB.month = input;
                                            terminalData.prompt = 'Year (YYYY): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            this.printLine('', terminalData);
                                            this.printLine('Year (numbers only):', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                        } else if (terminalData.prompt === 'Year (YYYY): ') {
                                            // Handle Reset command
                                            if (input.toLowerCase() === 'reset') {
                                                // Reset DOB completely
                                                terminalData.awaitingForgotFirstName = false;
                                                terminalData.awaitingForgotLastName = false;
                                                terminalData.awaitingForgotDOB = true;
                                                terminalData.forgotDOB = null;
                                                terminalData.prompt = 'Day (DD): ';
                                                terminalData.currentInput = '';
                                                terminalData.shouldCapitalizeNext = true;
                                                terminalData.lastCharWasSentenceEnd = false;
                                                
                                                this.printLine('', terminalData);
                                                this.printLine('DOB reset. Starting fresh:', terminalData);
                                                this.playBeep();
                                                this.render(terminalData);
                                                return;
                                            }
                                            
                                            const year = parseInt(input);
                                            if (year < 1900 || year > 2025) {
                                                this.printLine('Error: Year must be between 1900 and 2025 or type "Reset" to reset DOB.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            terminalData.transcript += terminalData.prompt + input + '\n';
                                            terminalData.forgotDOB.year = input;
                                            
                                            // Create backup hash from user info
                                            try {
                                                const encoder = new TextEncoder();
                                                const toSha256Hex = async (inputValue) => {
                                                    const data = encoder.encode(inputValue);
                                                    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                                                    const hashArray = Array.from(new Uint8Array(hashBuffer));
                                                    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();
                                                };
                                                
                                                const backupInfo = `${terminalData.forgotFirstName}${terminalData.forgotLastName}${terminalData.forgotDOB.month}${terminalData.forgotDOB.day}${terminalData.forgotDOB.year}`;
                                                const backupHash = await toSha256Hex(backupInfo);
                                                
                                                this.printLine('', terminalData);
                                                this.printLine('Searching for account...', terminalData);
                                                this.printLine('', terminalData);
                                                
                                                try {
                                                    // Search for account by backup hash
                                                    const accountData = await window.HashDatabase.findAccountByBackupHash(backupHash);
                                                    
                                                    if (accountData) {
                                                        this.printLine('Back-up hash found:', terminalData);
                                                        this.printLine('"' + accountData.backupHash + '"', terminalData);
                                                        this.printLine('', terminalData);
                                                        this.printLine('Recovered password:', terminalData);
                                                        this.printLine('"' + accountData.plainPassword + '"', terminalData);
                                                        this.printLine('', terminalData);
                                                    } else {
                                                        this.printLine('Couldnt find any accounts with this hash-key', terminalData);
                                                        this.printLine('', terminalData);
                                                    }
                                                } catch (error) {
                                                    this.printLine('Error searching for account: ' + error.message, terminalData);
                                                    this.printLine('', terminalData);
                                                }
                                            } catch (hashError) {
                                                this.printLine('Error generating hash: ' + hashError.message, terminalData);
                                                this.printLine('Please ensure you are using a secure connection (HTTPS)', terminalData);
                                                this.printLine('', terminalData);
                                            }
                                            
                                            // Reset forgot process
                                            terminalData.awaitingForgotFirstName = false;
                                            terminalData.awaitingForgotLastName = false;
                                            terminalData.awaitingForgotDOB = false;
                                            terminalData.forgotFirstName = null;
                                            terminalData.forgotLastName = null;
                                            terminalData.forgotDOB = null;
                                            terminalData.prompt = this.defaultPrompt;
                                            terminalData.previousPrompt = null;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            
                                            this.printLine('Process completed.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                    }

                                    return originalExecuteCommand(raw, terminalData);
                                };
                                TerminalManager._loginFirstNamePatched = true;
                            }
                            
                            TerminalManager.addCommand('Login_Terminal_Content_Terminal_Main_Text', 'signup', function(context) {
                                context.print('Opening sign-up window...');
                                // Open signup window
                                const signupWindow = document.getElementById('Sign-Up_Terminal');
                                if (signupWindow) {
                                    signupWindow.style.display = 'flex';
                                    const signupTerminal = TerminalManager.getTerminal('Sign-Up_Terminal_Content_Terminal_Main_Text');
                                    if (signupTerminal) {
                                        signupTerminal.shouldScrollToBottom = true;
                                        // Reset welcomeStarted and transcript to trigger animations on open
                                        signupTerminal.welcomeStarted = false;
                                        signupTerminal.transcript = '';
                                        TerminalManager.render(signupTerminal);
                                    }
                                }
                            }, 'Open sign-up window');
                            
                            TerminalManager.addCommand('Login_Terminal_Content_Terminal_Main_Text', 'forgot', function(context) {
                                context.print('Opening forgot password terminal...');
                                // Open forgot password window
                                const forgotWindow = document.getElementById('Forgot_Terminal');
                                if (forgotWindow) {
                                    forgotWindow.style.display = 'flex';
                                    const forgotTerminal = TerminalManager.getTerminal('Forgot_Terminal_Content_Terminal_Main_Text');
                                    if (forgotTerminal) {
                                        forgotTerminal.shouldScrollToBottom = true;
                                        // Reset welcomeStarted and transcript to trigger animations on open
                                        forgotTerminal.welcomeStarted = false;
                                        forgotTerminal.transcript = '';
                                        TerminalManager.render(forgotTerminal);
                                    }
                                }
                            }, 'Open forgot password terminal');
                            
                            TerminalManager.addCommand('Login_Terminal_Content_Terminal_Main_Text', 'change', function(context) {
                                context.print('Opening change password terminal...');
                                // Open change password window
                                const changeWindow = document.getElementById('Change_Password_Terminal');
                                if (changeWindow) {
                                    changeWindow.style.display = 'flex';
                                    const changeTerminal = TerminalManager.getTerminal('Change_Password_Terminal_Content_Terminal_Main_Text');
                                    if (changeTerminal) {
                                        changeTerminal.shouldScrollToBottom = true;
                                        // Reset welcomeStarted and transcript to trigger animations on open
                                        changeTerminal.welcomeStarted = false;
                                        changeTerminal.transcript = '';
                                        TerminalManager.render(changeTerminal);
                                    }
                                }
                            }, 'Open change password terminal');
                            
                            TerminalManager.addCommand('Login_Terminal_Content_Terminal_Main_Text', 'license', function(context) {
                                context.print('');
                                context.print('MIT License');
                                context.print('');
                                context.print('Copyright (c) 2025 dtron7th');
                                context.print('');
                                context.print('Permission is hereby granted, free of charge, to any person obtaining a copy');
                                context.print('of this software and associated documentation files (the "Software"), to deal');
                                context.print('in the Software without restriction, including without limitation the rights');
                                context.print('to use, copy, modify, merge, publish, distribute, sublicense, and/or sell');
                                context.print('copies of the Software, and to permit persons to whom the Software is');
                                context.print('furnished to do so, subject to the following conditions:');
                                context.print('');
                                context.print('The above copyright notice and this permission notice shall be included in all');
                                context.print('copies or substantial portions of the Software.');
                                context.print('');
                                context.print('THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR');
                                context.print('IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,');
                                context.print('FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE');
                                context.print('AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER');
                                context.print('LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,');
                                context.print('OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE');
                                context.print('SOFTWARE.');
                                context.print('');
                            }, 'View MIT license');
                        });
                    </script>
                </div>

                <style aria-label="Login_Terminal - Style">
                   
                </style>

                <script aria-label="Login_Terminal - Script">
                    document.getElementById('Login_Terminal_Close').addEventListener('click', function() {
                        // Clear terminal data before closing
                        const terminal = TerminalManager.getTerminal('Login_Terminal_Content_Terminal_Main_Text');
                        if (terminal) {
                            TerminalManager.clearTerminalData(terminal);
                            // Reset login-specific state variables to ensure default prompt on reopen
                            terminal.awaitingFirstName = false;
                            terminal.awaitingLastName = false;
                            terminal.awaitingPassword = false;
                            terminal.firstName = null;
                            terminal.lastName = null;
                            terminal.password = null;
                            terminal.previousPrompt = null;
                            terminal.prompt = TerminalManager.defaultPrompt;
                            terminal.passwordMode = false;
                        }
                        document.getElementById('Login_Terminal').style.display = 'none';
                    });
                </script>
            </div>

            <div class="Terminal" id="Sign-Up_Terminal">
                <div class="Header" id="Sign-Up_Terminal_Header">
                    <p class="Title">Sign Up</p>
                    <div class="Terminal_Manipulation">
                        <button class="Terminal_Minimize" id="Sign-Up_Terminal_Minimize"></button>
                        <button class="Terminal_Maximize" id="Sign-Up_Terminal_Maximize"></button>
                        <button class="Terminal_Close" id="Sign-Up_Terminal_Close"></button>
                    </div>
                </div>
                <div class="Content" id="Sign-Up_Terminal_Content_Terminal">
                    <p id="Sign-Up_Terminal_Content_Terminal_Main_Text" class="terminal" contenteditable="true" tabindex="0" spellcheck="false" autocorrect="off" autocapitalize="off" autocomplete="off"></p>

                    <style aria-label="Sign-Up_Terminal_Content_Terminal - Style">
                        #Sign-Up_Terminal_Content_Terminal {
                            background-color: var(--Terminal_Background_Color);
                        }

                        #Sign-Up_Terminal_Content_Terminal_Main_Text {
                            position: absolute;
                            top: 10px;
                            left: 10px;
                            width: calc(100% - 20px);
                            height: calc(100% - 20px);
                            color: var(--Terminal_Text_Color);
                            overflow: auto;
                            overflow-anchor: none;
                            white-space: pre-wrap;
                            line-height: 1.45;
                            outline: none;
                            -webkit-user-modify: read-write-plaintext-only;
                            -webkit-tap-highlight-color: transparent;
                            -webkit-touch-callout: none;
                            -webkit-user-select: text;
                            user-select: text;
                        }

                        @media (max-width: 768px) {
                            #Sign-Up_Terminal_Content_Terminal_Main_Text {
                                font-size: 11px;
                                line-height: 1.4;
                            }
                        }
                    </style>

                    <script aria-label="Sign-Up_Terminal_Content_Terminal - Script">
                        document.addEventListener('DOMContentLoaded', function() {
                            // Register the signup terminal with TerminalManager
                            const terminal = TerminalManager.registerTerminal('Sign-Up_Terminal_Content_Terminal_Main_Text', {
                                windowId: 'Sign-Up_Terminal',
                                prompt: TerminalManager.defaultPrompt, // Use default prompt from manager
                                welcomeMessages: [
                                    'Vista-D-NET Sign-Up.',
                                    '',
                                    function(terminal) {
                                        TerminalManager.displayCommandList(terminal, TerminalManager.getSignupCommandList());
                                    },
                                    ''
                                ]
                            });
                            
                            // Add custom commands
                            TerminalManager.addCommand('Sign-Up_Terminal_Content_Terminal_Main_Text', 'signup', function(context) {
                                const signupTerminal = context.terminalData;
                                if (!signupTerminal) {
                                    return;
                                }

                                signupTerminal.awaitingSignupFirstName = true;
                                signupTerminal.previousPrompt = signupTerminal.prompt;
                                signupTerminal.prompt = 'First Name: ';
                                signupTerminal.currentInput = '';
                                context.print('');
                                context.print('=== Sign up for an account. (Hash is case sensitive) ===');
                                context.print('');
                                context.print('Enter your first name:');
                                TerminalManager.triggerPromptJump(signupTerminal);
                            }, 'Start sign-up process');

                            TerminalManager.addCommand('Sign-Up_Terminal_Content_Terminal_Main_Text', 'clear', function(context) {
                                const signupTerminal = context.terminalData;
                                if (!signupTerminal) {
                                    return;
                                }
                                
                                // Reset all signup state variables
                                signupTerminal.awaitingSignupFirstName = false;
                                signupTerminal.awaitingSignupLastName = false;
                                signupTerminal.awaitingSignupDOB = false;
                                signupTerminal.awaitingSignupPassword = false;
                                signupTerminal.signupFirstName = null;
                                signupTerminal.signupLastName = null;
                                signupTerminal.signupDOB = null;
                                signupTerminal.signupPassword = null;
                                signupTerminal.previousPrompt = null;
                                signupTerminal.prompt = TerminalManager.defaultPrompt;
                                signupTerminal.passwordMode = false;
                                signupTerminal.currentInput = '';
                                
                                // Clear the terminal display
                                context.clear();
                                
                                // Show welcome messages again
                                context.print('Vista-D-NET Sign-Up.');
                                context.print('');
                                TerminalManager.displayCommandList(signupTerminal, TerminalManager.getSignupCommandList());
                                context.print('');
                                TerminalManager.triggerPromptJump(signupTerminal);
                            }, 'Clear signup process and start over');
                            
                            // Add Reset command
                            TerminalManager.addCommand('Sign-Up_Terminal_Content_Terminal_Main_Text', 'reset', function(context) {
                                const signupTerminal = context.terminalData;
                                if (!signupTerminal) {
                                    return;
                                }
                                
                                context.print('Reset command available during information process input to reset data entry.');
                                context.print('Type [Signup] to start the sign-up process.');
                                context.print('');
                                TerminalManager.triggerPromptJump(signupTerminal);
                            }, 'Reset command for signup process');

                            if (!TerminalManager._signupFirstNamePatched) {
                                const previousExecuteCommand = TerminalManager.executeCommand.bind(TerminalManager);
                                TerminalManager.executeCommand = async function(raw, terminalData) {
                                    
                                    // ==================== FIRST NAME INPUT ====================
                                    if (terminalData && terminalData.id === 'Sign-Up_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingSignupFirstName) {
                                        const firstName = (raw || '').trim();
                                        
                                        // Check if user wants to clear
                                        if (firstName.toLowerCase() === 'clear') {
                                            // Reset all signup state variables
                                            terminalData.awaitingSignupFirstName = true;
                                            terminalData.awaitingSignupLastName = false;
                                            terminalData.awaitingSignupDOB = false;
                                            terminalData.awaitingSignupPassword = false;
                                            terminalData.signupFirstName = null;
                                            terminalData.signupLastName = null;
                                            terminalData.signupDOB = null;
                                            terminalData.signupPassword = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Clearing signup process...', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            this.triggerPromptJump(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to reset
                                        if (firstName.toLowerCase() === 'reset') {
                                            // Reset to first name (same as clear for first name)
                                            terminalData.awaitingSignupFirstName = true;
                                            terminalData.awaitingSignupLastName = false;
                                            terminalData.awaitingSignupDOB = false;
                                            terminalData.awaitingSignupPassword = false;
                                            terminalData.signupFirstName = null;
                                            terminalData.signupLastName = null;
                                            terminalData.signupDOB = null;
                                            terminalData.signupPassword = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Reset to first name entry:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            this.triggerPromptJump(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to exit
                                        if (firstName.toLowerCase() === 'exit') {
                                            
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            this.triggerPromptJump(terminalData);
                                            return;
                                        }
                                        
                                        if (!firstName) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        terminalData.transcript += terminalData.prompt + firstName + '\n';
                                        terminalData.awaitingSignupFirstName = false;
                                        terminalData.signupFirstName = firstName;
                                        terminalData.awaitingSignupLastName = true;
                                        terminalData.prompt = 'Last Name: ';
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        this.printLine('', terminalData);
                                        this.printLine('Enter your last name:', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        this.triggerPromptJump(terminalData);
                                        return;
                                    }

                                    // ==================== LAST NAME INPUT ====================
                                    if (terminalData && terminalData.id === 'Sign-Up_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingSignupLastName) {
                                        const lastName = (raw || '').trim();
                                        
                                        // Check if user wants to clear
                                        if (lastName.toLowerCase() === 'clear') {
                                            // Reset all signup state variables
                                            terminalData.awaitingSignupFirstName = true;
                                            terminalData.awaitingSignupLastName = false;
                                            terminalData.awaitingSignupDOB = false;
                                            terminalData.awaitingSignupPassword = false;
                                            terminalData.signupFirstName = null;
                                            terminalData.signupLastName = null;
                                            terminalData.signupDOB = null;
                                            terminalData.signupPassword = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Clearing signup process...', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to reset
                                        if (lastName.toLowerCase() === 'reset') {
                                            // Reset to first name
                                            terminalData.awaitingSignupFirstName = true;
                                            terminalData.awaitingSignupLastName = false;
                                            terminalData.awaitingSignupDOB = false;
                                            terminalData.awaitingSignupPassword = false;
                                            terminalData.signupFirstName = null;
                                            terminalData.signupLastName = null;
                                            terminalData.signupDOB = null;
                                            terminalData.signupPassword = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Reset to first name entry:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to exit
                                        if (lastName.toLowerCase() === 'exit') {
                                            
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!lastName) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        terminalData.transcript += terminalData.prompt + lastName + '\n';
                                        terminalData.awaitingSignupLastName = false;
                                        terminalData.signupLastName = lastName;
                                        terminalData.awaitingSignupDOB = true;
                                        terminalData.prompt = 'Day (DD): ';
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        this.printLine('', terminalData);
                                        this.printLine('Enter your date of birth:', terminalData);
                                        this.printLine('Day (numbers only):', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }

                                    // ==================== DATE OF BIRTH INPUT ====================
                                    if (terminalData && terminalData.id === 'Sign-Up_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingSignupDOB) {
                                        const input = (raw || '').trim();
                                        
                                        // Check if user wants to clear
                                        if (input.toLowerCase() === 'clear') {
                                            // Reset all signup state variables
                                            terminalData.awaitingSignupFirstName = true;
                                            terminalData.awaitingSignupLastName = false;
                                            terminalData.awaitingSignupDOB = false;
                                            terminalData.awaitingSignupPassword = false;
                                            terminalData.signupFirstName = null;
                                            terminalData.signupLastName = null;
                                            terminalData.signupDOB = null;
                                            terminalData.signupPassword = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Clearing signup process...', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to exit
                                        if (input.toLowerCase() === 'exit') {
                                            
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!input) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        // Check if input contains only numbers or is Reset command
                                        if (!/^\d+$/.test(input) && input.toLowerCase() !== 'reset') {
                                            this.printLine('Error: Please enter numbers only or type "Reset" to reset DOB.', terminalData);
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Handle Reset command
                                        if (input.toLowerCase() === 'reset') {
                                            const isDayPrompt = (terminalData.prompt || '').trim().startsWith('Day (DD):');

                                            if (isDayPrompt) {
                                                // Reset to first-name entry when reset is executed on day prompt
                                                terminalData.awaitingSignupFirstName = true;
                                                terminalData.awaitingSignupLastName = false;
                                                terminalData.awaitingSignupDOB = false;
                                                terminalData.awaitingSignupPassword = false;
                                                terminalData.signupFirstName = null;
                                                terminalData.signupLastName = null;
                                                terminalData.signupDOB = null;
                                                terminalData.signupPassword = null;
                                                terminalData.prompt = 'First Name: ';
                                            } else {
                                                // Reset DOB entry back to day prompt for month/year
                                                terminalData.awaitingSignupFirstName = false;
                                                terminalData.awaitingSignupLastName = false;
                                                terminalData.awaitingSignupDOB = true;
                                                terminalData.awaitingSignupPassword = false;
                                                terminalData.signupDOB = null;
                                                terminalData.prompt = 'Day (DD): ';
                                            }
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            
                                            this.printLine('', terminalData);
                                            this.printLine(isDayPrompt ? 'Reset to first name entry:' : 'DOB reset. Starting fresh:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }

                                        if (!terminalData.signupDOB) {
                                            terminalData.signupDOB = {};
                                        }

                                        if (terminalData.prompt === 'Day (DD): ') {
                                            // Check if input is exactly 2 digits
                                            if (input.length !== 2) {
                                                this.printLine('Error: Day must be exactly 2 digits (e.g., 01, 05, 15).', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            
                                            const day = parseInt(input);
                                            if (day < 1 || day > 31) {
                                                this.printLine('Error: Day must be between 01 and 31.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            terminalData.transcript += terminalData.prompt + input + '\n';
                                            terminalData.signupDOB.day = input;
                                            terminalData.prompt = 'Month (MM): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            this.printLine('', terminalData);
                                            this.printLine('Month (numbers only):', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                        } else if (terminalData.prompt === 'Month (MM): ') {
                                            // Check if input is exactly 2 digits or is Reset command
                                            if (input.length !== 2 && input.toLowerCase() !== 'reset') {
                                                this.printLine('Error: Month must be exactly 2 digits (e.g., 01, 05, 12) or type "Reset" to reset DOB.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            
                                            // Handle Reset command
                                            if (input.toLowerCase() === 'reset') {
                                                // Reset DOB completely
                                                terminalData.awaitingSignupFirstName = false;
                                                terminalData.awaitingSignupLastName = false;
                                                terminalData.awaitingSignupDOB = true;
                                                terminalData.awaitingSignupPassword = false;
                                                terminalData.signupDOB = null;
                                                terminalData.prompt = 'Day (DD): ';
                                                terminalData.currentInput = '';
                                                terminalData.shouldCapitalizeNext = true;
                                                terminalData.lastCharWasSentenceEnd = false;
                                                
                                                this.printLine('', terminalData);
                                                this.printLine('DOB reset. Starting fresh:', terminalData);
                                                this.playBeep();
                                                this.render(terminalData);
                                                return;
                                            }
                                            const month = parseInt(input);
                                            if (month < 1 || month > 12) {
                                                this.printLine('Error: Month must be between 01 and 12.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            terminalData.transcript += terminalData.prompt + input + '\n';
                                            terminalData.signupDOB.month = input;
                                            terminalData.prompt = 'Year (YYYY): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            this.printLine('', terminalData);
                                            this.printLine('Year (numbers only):', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                        } else if (terminalData.prompt === 'Year (YYYY): ') {
                                            // Handle Reset command
                                            if (input.toLowerCase() === 'reset') {
                                                // Reset DOB completely
                                                terminalData.awaitingSignupFirstName = false;
                                                terminalData.awaitingSignupLastName = false;
                                                terminalData.awaitingSignupDOB = true;
                                                terminalData.awaitingSignupPassword = false;
                                                terminalData.signupDOB = null;
                                                terminalData.prompt = 'Day (DD): ';
                                                terminalData.currentInput = '';
                                                terminalData.shouldCapitalizeNext = true;
                                                terminalData.lastCharWasSentenceEnd = false;
                                                
                                                this.printLine('', terminalData);
                                                this.printLine('DOB reset. Starting fresh:', terminalData);
                                                this.playBeep();
                                                this.render(terminalData);
                                                return;
                                            }
                                            
                                            const year = parseInt(input);
                                            if (year < 1900 || year > 2025) {
                                                this.printLine('Error: Year must be between 1900 and 2025 or type "Reset" to reset DOB.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            terminalData.transcript += terminalData.prompt + input + '\n';
                                            terminalData.signupDOB.year = input;
                                            terminalData.awaitingSignupDOB = false;
                                            terminalData.previousPrompt = null;
                                            terminalData.awaitingSignupPassword = true;
                                            terminalData.prompt = 'Password: ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = false;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.passwordMode = true;
                                            this.printLine('', terminalData);
                                            this.printLine('Date of birth: ' + terminalData.signupDOB.month + '/' + terminalData.signupDOB.day + '/' + terminalData.signupDOB.year, terminalData);
                                            this.printLine('', terminalData);
                                            this.printLine('Enter your password:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            
                                            return;
                                        }

                                        this.render(terminalData);
                                        return;
                                    }

                                    // ==================== PASSWORD INPUT ====================
                                    if (terminalData && terminalData.id === 'Sign-Up_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingSignupPassword) {
                                        const password = (raw || '').trim();
                                        
                                        // Check if user wants to undo
                                        if (password.toLowerCase() === 'undo') {
                                            // Step back to year input
                                            terminalData.awaitingSignupFirstName = false;
                                            terminalData.awaitingSignupLastName = false;
                                            terminalData.awaitingSignupDOB = true;
                                            terminalData.awaitingSignupPassword = false;
                                            terminalData.prompt = 'Year (YYYY): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.passwordMode = false;
                                            // Remove the stored year value but keep day and month
                                            if (terminalData.signupDOB) {
                                                terminalData.signupDOB.year = null;
                                            }
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Stepped back to year entry:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to clear
                                        if (password.toLowerCase() === 'clear') {
                                            // Reset all signup state variables
                                            terminalData.awaitingSignupFirstName = true;
                                            terminalData.awaitingSignupLastName = false;
                                            terminalData.awaitingSignupDOB = false;
                                            terminalData.awaitingSignupPassword = false;
                                            terminalData.signupFirstName = null;
                                            terminalData.signupLastName = null;
                                            terminalData.signupDOB = null;
                                            terminalData.signupPassword = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.prompt = 'First Name: ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Clearing signup process...', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to exit
                                        if (password.toLowerCase() === 'exit') {
                                            
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Check if user wants to reset
                                        if (password.toLowerCase() === 'reset') {
                                            
                                            // Reset to DOB entry
                                            terminalData.awaitingSignupFirstName = false;
                                            terminalData.awaitingSignupLastName = false;
                                            terminalData.awaitingSignupDOB = true;
                                            terminalData.awaitingSignupPassword = false;
                                            terminalData.signupDOB = null;
                                            terminalData.signupPassword = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.prompt = 'Day (DD): ';
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Reset to DOB entry:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!password) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        // Add masked password to transcript
                                        terminalData.transcript += terminalData.prompt + '*'.repeat(password.length) + '\n';
                                        terminalData.awaitingSignupPassword = false;
                                        terminalData.signupPassword = password;
                                        terminalData.passwordMode = false;
                                        terminalData.prompt = 'Password: ';
                                        terminalData.previousPrompt = null;
                                        terminalData.currentInput = '';
                                        this.printLine('', terminalData);
                                        this.printLine('Sign-up successful! - ' + terminalData.signupFirstName + '/' + terminalData.signupLastName + '/' + terminalData.signupDOB.month + '/' + terminalData.signupDOB.day + '/' + terminalData.signupDOB.year + '/' + '*'.repeat(password.length) + '/', terminalData);

                                        let hashStored = false;
                                        let hashId = null;
                                        let hashExists = false;
                                        
                                        // Keep password prompt during hash processing; reset to default after processing
                                        terminalData.prompt = 'Password: ';
                                        
                                        // Combine credentials and generate SHA-256
                                        try {
                                            const encoder = new TextEncoder();
                                            const toSha256Hex = async (inputValue) => {
                                                const data = encoder.encode(inputValue);
                                                const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                                                const hashArray = Array.from(new Uint8Array(hashBuffer));
                                                return hashArray.map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();
                                            };

                                            const primaryCombined = terminalData.signupFirstName + terminalData.signupLastName + terminalData.signupPassword;
                                            const primaryHashHex = await toSha256Hex(primaryCombined);
                                            const backupCombined = terminalData.signupFirstName + terminalData.signupLastName + terminalData.signupDOB.month + terminalData.signupDOB.day + terminalData.signupDOB.year;
                                            const backupHashHex = await toSha256Hex(backupCombined);
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('Primary Account Hash:', terminalData);
                                            this.printLine('Hash "' + primaryHashHex + '"', terminalData);
                                            this.printLine('Including ' + terminalData.signupFirstName + '/' + terminalData.signupLastName + '/' + '*'.repeat(terminalData.signupPassword.length) + ',', terminalData);
                                            this.printLine('', terminalData);
                                            this.printLine('Backup Account Hash', terminalData);
                                            this.printLine('Hash "' + backupHashHex + '"', terminalData);
                                            this.printLine('Including ' + terminalData.signupFirstName + '/' + terminalData.signupLastName + '/' + terminalData.signupDOB.month + '/' + terminalData.signupDOB.day + '/' + terminalData.signupDOB.year, terminalData);
                                            
                                            // Keep password prompt while processing
                                            terminalData.prompt = 'Password: ';
                                            
                                            // Store hash in database
                                            if (window.HashDatabase) {
                                                try {
                                                    hashId = await window.HashDatabase.storeHash(primaryHashHex, backupHashHex, terminalData.signupPassword, 'signup');
                                                    hashStored = true;
                                                    this.printLine('', terminalData);
                                                    
                                                    // Keep password prompt while processing
                                                    terminalData.prompt = 'Password: ';
                                                } catch (dbError) {
                                                    this.printLine('', terminalData);
                                                    this.printLine('ERROR: Failed to store hash data - ' + dbError.message, terminalData);
                                                    this.printLine('Account creation incomplete - please try again', terminalData);
                                                }
                                            } else {
                                                this.printLine('', terminalData);
                                                this.printLine('ERROR: Database system not available', terminalData);
                                                this.printLine('Account creation incomplete - please refresh and try again', terminalData);
                                            }
                                            
                                        } catch (error) {
                                            this.printLine('Error generating hash: ' + error.message, terminalData);
                                            terminalData.prompt = 'Password: ';
                                        }
                                        
                                        // Check final status and show appropriate message
                                        if (hashStored && hashId) {
                                            this.printLine('', terminalData);
                                            this.printLine('Successfully created an account!', terminalData);
                                            this.printLine('Account is stored into the database.', terminalData);
                                        } else if (hashExists) {
                                            // Hash already exists case - no additional message needed
                                        } else {
                                            this.printLine('', terminalData);
                                            this.printLine('ERROR: No data was stored - account not created.', terminalData);
                                            this.printLine('Please try again', terminalData);
                                        }
                                        
                                        // Return to default command prompt after hash processing
                                        terminalData.prompt = this.defaultPrompt;
                                        terminalData.previousPrompt = null;
                                        terminalData.passwordMode = false;
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        
                                        this.printLine('', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }

                                    // ==================== FORGOT PASSWORD PROCESS ====================
                                    if (terminalData && terminalData.id === 'Forgot_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingForgotFirstName) {
                                        const firstName = (raw || '').trim();
                                        
                                        // Check for terminal commands first
                                        const commandName = firstName.toLowerCase();
                                        if (commandName === 'reset') {
                                            // Check if we're in the first question of a data set
                                            const isFirstQuestion = terminalData.awaitingForgotFirstName;
                                            
                                            if (isFirstQuestion) {
                                                // Save current state before clearing
                                                this.saveState(terminalData);
                                                
                                                // Clear the current data set completely
                                                this.clearCurrentDataSet(terminalData);
                                                
                                                // Try to restore the previous data set (if available)
                                                if (terminalData.stateHistory && terminalData.stateHistory.length > 1) {
                                                    // Remove the current state we just saved
                                                    terminalData.stateHistory.pop();
                                                    
                                                    // Restore the previous state
                                                    if (this.restoreState(terminalData, -1)) {
                                                        this.printLine('Current data set cleared. Returned to previous data set.', terminalData);
                                                        this.printLine('Use "undo" command to restore the cleared data set if needed.', terminalData);
                                                    } else {
                                                        this.printLine('Current data set cleared. No previous data set available.', terminalData);
                                                    }
                                                } else {
                                                    // No previous state, just show cleared state
                                                    this.printLine('Current data set cleared. No previous data set to restore.', terminalData);
                                                }
                                            } else {
                                                this.printLine('Reset command executed. Use specific reset commands during input processes.', terminalData);
                                            }
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (commandName === 'clear') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process cleared. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (commandName === 'exit') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!firstName) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        terminalData.transcript += terminalData.prompt + firstName + '\n';
                                        terminalData.awaitingForgotFirstName = false;
                                        terminalData.forgotFirstName = firstName;
                                        terminalData.awaitingForgotLastName = true;
                                        terminalData.prompt = 'Last Name: ';
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        this.printLine('', terminalData);
                                        this.printLine('Enter your last name:', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }

                                    // ==================== FORGOT PASSWORD LAST NAME ====================
                                    if (terminalData && terminalData.id === 'Forgot_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingForgotLastName) {
                                        const lastName = (raw || '').trim();
                                        
                                        // Check for terminal commands first
                                        const commandName = lastName.toLowerCase();
                                        if (commandName === 'reset') {
                                            // Reset to first name entry
                                            terminalData.awaitingForgotFirstName = true;
                                            terminalData.awaitingForgotLastName = false;
                                            terminalData.awaitingForgotDOB = false;
                                            terminalData.forgotFirstName = null;
                                            terminalData.forgotLastName = null;
                                            terminalData.forgotDOB = null;
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.prompt = 'First Name: ';

                                            this.printLine('', terminalData);
                                            this.printLine('Reset to first name entry:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }

                                        if (commandName === 'clear') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process cleared. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (commandName === 'exit') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!lastName) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        terminalData.transcript += terminalData.prompt + lastName + '\n';
                                        terminalData.awaitingForgotLastName = false;
                                        terminalData.forgotLastName = lastName;
                                        terminalData.awaitingForgotDOB = true;
                                        terminalData.prompt = 'Day (DD): ';
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        this.printLine('', terminalData);
                                        this.printLine('Enter your date of birth:', terminalData);
                                        this.printLine('Day (numbers only):', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }

                                    // ==================== FORGOT PASSWORD DOB ====================
                                    if (terminalData && terminalData.id === 'Forgot_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingForgotDOB) {
                                        const input = (raw || '').trim();
                                        
                                        // Check for terminal commands first
                                        const commandName = input.toLowerCase();
                                        if (commandName === 'reset') {
                                            const isDayPrompt = (terminalData.prompt || '').trim().startsWith('Day (DD):');

                                            if (isDayPrompt) {
                                                // Reset to first-name entry when reset is executed on day prompt
                                                terminalData.awaitingForgotFirstName = true;
                                                terminalData.awaitingForgotLastName = false;
                                                terminalData.awaitingForgotDOB = false;
                                                terminalData.forgotFirstName = null;
                                                terminalData.forgotLastName = null;
                                                terminalData.forgotDOB = null;
                                                terminalData.prompt = 'First Name: ';
                                            } else {
                                                // Reset DOB entry back to day prompt for month/year
                                                terminalData.awaitingForgotFirstName = false;
                                                terminalData.awaitingForgotLastName = false;
                                                terminalData.awaitingForgotDOB = true;
                                                terminalData.forgotDOB = null;
                                                terminalData.prompt = 'Day (DD): ';
                                            }
                                            terminalData.previousPrompt = null;
                                            terminalData.passwordMode = false;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;

                                            this.printLine('', terminalData);
                                            this.printLine(isDayPrompt ? 'Reset to first name entry:' : 'DOB reset. Starting fresh:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }

                                        if (commandName === 'clear') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process cleared. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (commandName === 'exit') {
                                            // Save current state
                                            this.saveState(terminalData);
                                            
                                            // Clear the current process and return to default prompt
                                            this.clearCurrentDataSet(terminalData);
                                            
                                            this.printLine('Process exited. Returned to default prompt.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        if (!input) {
                                            this.render(terminalData);
                                            return;
                                        }

                                        // Check if input contains only numbers or is Reset command
                                        if (!/^\d+$/.test(input) && input.toLowerCase() !== 'reset') {
                                            this.printLine('Error: Please enter numbers only or type "Reset" to reset DOB.', terminalData);
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Handle Reset command
                                        if (input.toLowerCase() === 'reset') {
                                            // Reset DOB completely
                                            terminalData.awaitingForgotFirstName = false;
                                            terminalData.awaitingForgotLastName = false;
                                            terminalData.awaitingForgotDOB = true;
                                            terminalData.forgotDOB = null;
                                            terminalData.prompt = 'Day (DD): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('DOB reset. Starting fresh:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }

                                        if (!terminalData.forgotDOB) {
                                            terminalData.forgotDOB = {};
                                        }

                                        if (terminalData.prompt === 'Day (DD): ') {
                                            // Check if input is exactly 2 digits
                                            if (input.length !== 2) {
                                                this.printLine('Error: Day must be exactly 2 digits (e.g., 01, 05, 15).', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            
                                            const day = parseInt(input);
                                            if (day < 1 || day > 31) {
                                                this.printLine('Error: Day must be between 01 and 31.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            terminalData.transcript += terminalData.prompt + input + '\n';
                                            terminalData.forgotDOB.day = input;
                                            terminalData.prompt = 'Month (MM): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            this.printLine('', terminalData);
                                            this.printLine('Month (numbers only):', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                        } else if (terminalData.prompt === 'Month (MM): ') {
                                            // Check if input is exactly 2 digits or is Reset command
                                            if (input.length !== 2 && input.toLowerCase() !== 'reset') {
                                                this.printLine('Error: Month must be exactly 2 digits (e.g., 01, 05, 12) or type "Reset" to reset DOB.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            
                                            // Handle Reset command
                                            if (input.toLowerCase() === 'reset') {
                                                // Reset DOB completely
                                                terminalData.awaitingForgotFirstName = false;
                                                terminalData.awaitingForgotLastName = false;
                                                terminalData.awaitingForgotDOB = true;
                                                terminalData.forgotDOB = null;
                                                terminalData.prompt = 'Day (DD): ';
                                                terminalData.currentInput = '';
                                                terminalData.shouldCapitalizeNext = true;
                                                terminalData.lastCharWasSentenceEnd = false;
                                                
                                                this.printLine('', terminalData);
                                                this.printLine('DOB reset. Starting fresh:', terminalData);
                                                this.playBeep();
                                                this.render(terminalData);
                                                return;
                                            }
                                            const month = parseInt(input);
                                            if (month < 1 || month > 12) {
                                                this.printLine('Error: Month must be between 01 and 12.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            terminalData.transcript += terminalData.prompt + input + '\n';
                                            terminalData.forgotDOB.month = input;
                                            terminalData.prompt = 'Year (YYYY): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            this.printLine('', terminalData);
                                            this.printLine('Year (numbers only):', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                        } else if (terminalData.prompt === 'Year (YYYY): ') {
                                            // Handle Reset command
                                            if (input.toLowerCase() === 'reset') {
                                                // Reset DOB completely
                                                terminalData.awaitingForgotFirstName = false;
                                                terminalData.awaitingForgotLastName = false;
                                                terminalData.awaitingForgotDOB = true;
                                                terminalData.forgotDOB = null;
                                                terminalData.prompt = 'Day (DD): ';
                                                terminalData.currentInput = '';
                                                terminalData.shouldCapitalizeNext = true;
                                                terminalData.lastCharWasSentenceEnd = false;
                                                
                                                this.printLine('', terminalData);
                                                this.printLine('DOB reset. Starting fresh:', terminalData);
                                                this.playBeep();
                                                this.render(terminalData);
                                                return;
                                            }
                                            
                                            const year = parseInt(input);
                                            if (year < 1900 || year > 2025) {
                                                this.printLine('Error: Year must be between 1900 and 2025 or type "Reset" to reset DOB.', terminalData);
                                                this.render(terminalData);
                                                return;
                                            }
                                            terminalData.transcript += terminalData.prompt + input + '\n';
                                            terminalData.forgotDOB.year = input;
                                            
                                            // Create backup hash from user info
                                            try {
                                                const encoder = new TextEncoder();
                                                const toSha256Hex = async (inputValue) => {
                                                    const data = encoder.encode(inputValue);
                                                    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                                                    const hashArray = Array.from(new Uint8Array(hashBuffer));
                                                    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();
                                                };
                                                
                                                const backupInfo = `${terminalData.forgotFirstName}${terminalData.forgotLastName}${terminalData.forgotDOB.month}${terminalData.forgotDOB.day}${terminalData.forgotDOB.year}`;
                                                const backupHash = await toSha256Hex(backupInfo);
                                                
                                                this.printLine('', terminalData);
                                                this.printLine('Searching for account...', terminalData);
                                                this.printLine('', terminalData);
                                                
                                                try {
                                                    // Search for account by backup hash
                                                    const accountData = await window.HashDatabase.findAccountByBackupHash(backupHash);
                                                    
                                                    if (accountData) {
                                                        this.printLine('Back-up hash found:', terminalData);
                                                        this.printLine('"' + accountData.backupHash + '"', terminalData);
                                                        this.printLine('', terminalData);
                                                        this.printLine('Recovered password:', terminalData);
                                                        this.printLine('"' + accountData.plainPassword + '"', terminalData);
                                                        this.printLine('', terminalData);
                                                    } else {
                                                        this.printLine('Couldnt find any accounts with this hash-key', terminalData);
                                                        this.printLine('', terminalData);
                                                    }
                                                } catch (error) {
                                                    this.printLine('Error searching for account: ' + error.message, terminalData);
                                                    this.printLine('', terminalData);
                                                }
                                            } catch (hashError) {
                                                this.printLine('Error generating hash: ' + hashError.message, terminalData);
                                                this.printLine('Please ensure you are using a secure connection (HTTPS)', terminalData);
                                                this.printLine('', terminalData);
                                            }
                                            
                                            // Reset forgot process
                                            terminalData.awaitingForgotFirstName = false;
                                            terminalData.awaitingForgotLastName = false;
                                            terminalData.awaitingForgotDOB = false;
                                            terminalData.forgotFirstName = null;
                                            terminalData.forgotLastName = null;
                                            terminalData.forgotDOB = null;
                                            terminalData.prompt = this.defaultPrompt;
                                            terminalData.previousPrompt = null;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            
                                            this.printLine('Process completed.', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                    }

                                    return previousExecuteCommand(raw, terminalData);
                                };
                                TerminalManager._signupFirstNamePatched = true;
                            }
                            
                            TerminalManager.addCommand('Sign-Up_Terminal_Content_Terminal_Main_Text', 'close', function(context) {
                                // Clear terminal data before closing
                                const signupTerminal = TerminalManager.getTerminal('Sign-Up_Terminal_Content_Terminal_Main_Text');
                                if (signupTerminal) {
                                    TerminalManager.clearTerminalData(signupTerminal);
                                }
                                document.getElementById('Sign-Up_Terminal').style.display = 'none';
                            }, 'Close sign-up window');
                        });
                    </script>
                </div>

                <style aria-label="Sign-Up_Terminal - Style">
                   
                </style>

                <script aria-label="Sign-Up_Terminal - Script">
                    document.getElementById('Sign-Up_Terminal_Close').addEventListener('click', function() {
                        // Clear terminal data before closing
                        const terminal = TerminalManager.getTerminal('Sign-Up_Terminal_Content_Terminal_Main_Text');
                        if (terminal) {
                            TerminalManager.clearTerminalData(terminal);
                            // Reset signup-specific state variables to ensure default prompt on reopen
                            terminal.awaitingSignupFirstName = false;
                            terminal.awaitingSignupLastName = false;
                            terminal.awaitingSignupDOB = false;
                            terminal.awaitingSignupPassword = false;
                            terminal.signupFirstName = null;
                            terminal.signupLastName = null;
                            terminal.signupDOB = null;
                            terminal.signupPassword = null;
                            terminal.previousPrompt = null;
                            terminal.prompt = TerminalManager.defaultPrompt;
                            terminal.passwordMode = false;
                        }
                        document.getElementById('Sign-Up_Terminal').style.display = 'none';
                    });
                </script>
            </div>

           


            <!--Book_Mark: Login_Build - Clock-->

            <div class="Login_Build_Clock">
                <p id="Login_Build_Clock_Time">00:00:00:000</p>
                <p id="Login_Build_Clock_Date">00/00/0000</p>

                <style aria-label="Login_Build_Clock - Style">
                    .Login_Build_Clock {
                        position: absolute;
                        top: 10px;
                        right: 10px;

                    }

                    p {
                        font-size: var(--Main_Font_Size);
                        color: rgb(255, 255, 255);
                    }
                    
                    #Login_Build_Clock_Date {
                        position: absolute;
                        right: 0px;
                    }
                </style>

                <script aria-label="Login_Build_Clock - Script">
                    function updateClock() {
                        const now = new Date();
                        const hours = String(now.getHours()).padStart(2, '0');
                        const minutes = String(now.getMinutes()).padStart(2, '0');
                        const seconds = String(now.getSeconds()).padStart(2, '0');
                        const milliseconds = String(now.getMilliseconds()).padStart(3, '0');
                        document.getElementById('Login_Build_Clock_Time').textContent = `${hours}:${minutes}:${seconds}:${milliseconds}`;
                        
                        const day = String(now.getDate()).padStart(2, '0');
                        const month = String(now.getMonth() + 1).padStart(2, '0');
                        const year = now.getFullYear();
                        document.getElementById('Login_Build_Clock_Date').textContent = `${day}/${month}/${year}`;
                    }
                    updateClock();
                    setInterval(updateClock, 10);
                    
                </script>
            </div>

            <!--Book_Mark: Login_Build - Printable_Information-->

            <div class="Login_Build_Printable_Information">
                <p id="Login_Build_Printable_Information_Wifi_Conntected"></p>
                <p id="Login_Build_Printable_Information_Wifi_Name"></p>
                
                <style aria-label="Login_Build_Printable_Information - Style">
                    .Login_Build_Printable_Information {
                        position: absolute;
                        top: 60px;
                        right: 10px;
                        font-size: var(--Main_Font_Size);
                        color: var(--Main_Text_Color);
                    }
                </style>
                <script aria-label="Login_Build_Printable_Information - Script">

                    const Login_Build_Printable_Information_wifiElement = document.getElementById('Login_Build_Printable_Information_Wifi_Conntected');

                    function updateWifiStatus() {
                        if (navigator.onLine) {
                            Login_Build_Printable_Information_wifiElement.textContent = 'Wifi Connected';
                            Login_Build_Printable_Information_wifiElement.style.color = 'green';
                        } else {
                            Login_Build_Printable_Information_wifiElement.textContent = 'Wifi Disconnected';
                            Login_Build_Printable_Information_wifiElement.style.color = 'red';
                        }
                    }

                    updateWifiStatus();
                    window.addEventListener('online', updateWifiStatus);
                    window.addEventListener('offline', updateWifiStatus);
                    
                </script>
            </div>

            <style aria-label=".Login_Build - Style">
                .Login_Build {
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    
                }
            </style>

            <script aria-label="Login_Build - Script">
                
            </script>

            
        </div>
        <!--Book_Mark: Login_Style-->
        <style aria-label="Login_Style">

            .Login {
                width: 100dvw;
                height: 100dvh;
                overflow: hidden;
            }

        </style>

    </div>
    
    <div class="Terminal" id="Forgot_Terminal">
                <div class="Header" id="Forgot_Terminal_Header">
                    <p class="Title">Forgot Password</p>
                    <div class="Terminal_Manipulation">
                        <button class="Terminal_Minimize" id="Forgot_Terminal_Minimize"></button>
                        <button class="Terminal_Maximize" id="Forgot_Terminal_Maximize"></button>
                        <button class="Terminal_Close" id="Forgot_Terminal_Close"></button>
                    </div>
                </div>
                <div class="Content" id="Forgot_Terminal_Content_Terminal">
                    <p id="Forgot_Terminal_Content_Terminal_Main_Text" class="terminal" contenteditable="true" tabindex="0" spellcheck="false" autocorrect="off" autocapitalize="off" autocomplete="off"></p>

                    <style aria-label="Forgot_Terminal_Content_Terminal - Style">
                        #Forgot_Terminal_Content_Terminal {
                            background-color: var(--Terminal_Background_Color);
                        }

                        #Forgot_Terminal_Content_Terminal_Main_Text {
                            position: absolute;
                            top: 10px;
                            left: 10px;
                            width: calc(100% - 20px);
                            height: calc(100% - 20px);
                            color: var(--Terminal_Text_Color);
                            overflow: auto;
                            overflow-anchor: none;
                            white-space: pre-wrap;
                            line-height: 1.45;
                            outline: none;
                            -webkit-user-modify: read-write-plaintext-only;
                            -webkit-tap-highlight-color: transparent;
                            -webkit-touch-callout: none;
                            -webkit-user-select: text;
                            user-select: text;
                        }

                        @media (max-width: 768px) {
                            #Forgot_Terminal_Content_Terminal_Main_Text {
                                font-size: 11px;
                                line-height: 1.4;
                            }
                        }
                    </style>

                    <script aria-label="Forgot_Terminal_Content_Terminal - Script">
                        document.addEventListener('DOMContentLoaded', function() {
                            // Register the forgot terminal with TerminalManager
                            const terminal = TerminalManager.registerTerminal('Forgot_Terminal_Content_Terminal_Main_Text', {
                                windowId: 'Forgot_Terminal',
                                prompt: TerminalManager.defaultPrompt, // Use default prompt from manager
                                welcomeMessages: [
                                    'Forgot Password.',
                                    '',
                                    function(terminal) {
                                        TerminalManager.displayCommandList(terminal, TerminalManager.getForgotCommandList());
                                    },
                                    ''
                                ]
                            });
                            
                            // Add custom commands
                            TerminalManager.addCommand('Forgot_Terminal_Content_Terminal_Main_Text', 'forgot', function(context) {
                                const forgotTerminal = context.terminalData;
                                if (!forgotTerminal) {
                                    return;
                                }

                                forgotTerminal.awaitingForgotFirstName = true;
                                forgotTerminal.previousPrompt = forgotTerminal.prompt;
                                forgotTerminal.prompt = 'First Name: ';
                                forgotTerminal.currentInput = '';
                                context.print('');
                                context.print('=== Password Recovery Process ===');
                                context.print('');
                                context.print('Enter your first name:');
                                TerminalManager.triggerPromptJump(forgotTerminal);
                            }, 'Start password recovery process');
                            
                            TerminalManager.addCommand('Forgot_Terminal_Content_Terminal_Main_Text', 'clear', function(context) {
                                const forgotTerminal = context.terminalData;
                                if (!forgotTerminal) {
                                    return;
                                }
                                
                                // Clear the terminal display
                                context.clear();
                                
                                // Show welcome messages again
                                context.print('Forgot Password.');
                                context.print('');
                                TerminalManager.displayCommandList(forgotTerminal, TerminalManager.getForgotCommandList());
                                context.print('');
                                TerminalManager.triggerPromptJump(forgotTerminal);
                            }, 'Clear forgot terminal and start over');
                            
                            // Add Reset command
                            TerminalManager.addCommand('Forgot_Terminal_Content_Terminal_Main_Text', 'reset', function(context) {
                                const forgotTerminal = context.terminalData;
                                if (!forgotTerminal) {
                                    return;
                                }
                                
                                context.print('Reset command available during information process input to reset data entry.');
                                context.print('');
                                TerminalManager.triggerPromptJump(forgotTerminal);
                            }, 'Reset command for forgot process');
                            
                            TerminalManager.addCommand('Forgot_Terminal_Content_Terminal_Main_Text', 'close', function(context) {
                                // Clear terminal data before closing
                                const forgotTerminal = TerminalManager.getTerminal('Forgot_Terminal_Content_Terminal_Main_Text');
                                if (forgotTerminal) {
                                    TerminalManager.clearTerminalData(forgotTerminal);
                                    // Reset forgot-specific state variables to ensure default prompt on reopen
                                    forgotTerminal.previousPrompt = null;
                                    forgotTerminal.prompt = TerminalManager.defaultPrompt;
                                    forgotTerminal.passwordMode = false;
                                }
                                document.getElementById('Forgot_Terminal').style.display = 'none';
                            }, 'Close forgot terminal');
                        });
                    </script>
                </div>

                <style aria-label="Forgot_Terminal - Style">
                   
                </style>

                <script aria-label="Forgot_Terminal - Script">
                    document.getElementById('Forgot_Terminal_Close').addEventListener('click', function() {
                        // Clear terminal data before closing
                        const forgotTerminal = TerminalManager.getTerminal('Forgot_Terminal_Content_Terminal_Main_Text');
                        if (forgotTerminal) {
                            TerminalManager.clearTerminalData(forgotTerminal);
                            // Reset forgot-specific state variables to ensure default prompt on reopen
                            forgotTerminal.previousPrompt = null;
                            forgotTerminal.prompt = TerminalManager.defaultPrompt;
                            forgotTerminal.passwordMode = false;
                        }
                        document.getElementById('Forgot_Terminal').style.display = 'none';
                    });
                </script>
            </div>

            <div class="Terminal" id="Change_Password_Terminal">
                <div class="Header" id="Change_Password_Terminal_Header">
                    <p class="Title">Change Password</p>
                    <div class="Terminal_Manipulation">
                        <button class="Terminal_Minimize" id="Change_Password_Terminal_Minimize"></button>
                        <button class="Terminal_Maximize" id="Change_Password_Terminal_Maximize"></button>
                        <button class="Terminal_Close" id="Change_Password_Terminal_Close"></button>
                    </div>
                </div>
                <div class="Content" id="Change_Password_Terminal_Content_Terminal">
                    <p id="Change_Password_Terminal_Content_Terminal_Main_Text" class="terminal" contenteditable="true" tabindex="0" spellcheck="false" autocorrect="off" autocapitalize="off" autocomplete="off"></p>

                    <style aria-label="Change_Password_Terminal_Content_Terminal - Style">
                        #Change_Password_Terminal_Content_Terminal {
                            background-color: var(--Terminal_Background_Color);
                        }

                        #Change_Password_Terminal_Content_Terminal_Main_Text {
                            position: absolute;
                            top: 10px;
                            left: 10px;
                            width: calc(100% - 20px);
                            height: calc(100% - 20px);
                            color: var(--Terminal_Text_Color);
                            overflow: auto;
                            overflow-anchor: none;
                            white-space: pre-wrap;
                            line-height: 1.45;
                            outline: none;
                            -webkit-user-modify: read-write-plaintext-only;
                            -webkit-tap-highlight-color: transparent;
                            -webkit-touch-callout: none;
                            -webkit-user-select: text;
                            user-select: text;
                        }

                        @media (max-width: 768px) {
                            #Change_Password_Terminal_Content_Terminal_Main_Text {
                                font-size: 11px;
                                line-height: 1.4;
                            }
                        }
                    </style>

                    <script aria-label="Change_Password_Terminal_Content_Terminal - Script">
                        document.addEventListener('DOMContentLoaded', function() {
                            // Register the change password terminal with TerminalManager
                            const terminal = TerminalManager.registerTerminal('Change_Password_Terminal_Content_Terminal_Main_Text', {
                                windowId: 'Change_Password_Terminal',
                                prompt: TerminalManager.defaultPrompt, // Use default prompt from manager
                                welcomeMessages: [
                                    'Vista-D-NET Change Password.',
                                    '',
                                    function(terminal) {
                                        TerminalManager.displayCommandList(terminal, TerminalManager.getChangeCommandList());
                                    },
                                    ''
                                ]
                            });
                            
                            // Add custom commands
                            TerminalManager.addCommand('Change_Password_Terminal_Content_Terminal_Main_Text', 'change', function(context) {
                                const changeTerminal = context.terminalData;
                                if (!changeTerminal) {
                                    return;
                                }

                                changeTerminal.awaitingChangeFirstName = true;
                                changeTerminal.previousPrompt = changeTerminal.prompt;
                                changeTerminal.prompt = 'First Name: ';
                                changeTerminal.currentInput = '';
                                context.print('');
                                context.print('=== Change password. (Hash is case sensitive) ===');
                                context.print('');
                                context.print('Enter your first name:');
                                TerminalManager.triggerPromptJump(changeTerminal);
                            }, 'Start change password process');

                            TerminalManager.addCommand('Change_Password_Terminal_Content_Terminal_Main_Text', 'clear', function(context) {
                                const changeTerminal = context.terminalData;
                                if (!changeTerminal) {
                                    return;
                                }
                                
                                // Reset all change password state variables
                                changeTerminal.awaitingChangeFirstName = false;
                                changeTerminal.awaitingChangeLastName = false;
                                changeTerminal.awaitingChangeDOB = false;
                                changeTerminal.awaitingChangePassword = false;
                                changeTerminal.awaitingChangeNewPassword = false;
                                changeTerminal.changeFirstName = null;
                                changeTerminal.changeLastName = null;
                                changeTerminal.changeDOB = null;
                                changeTerminal.changePassword = null;
                                changeTerminal.changeNewPassword = null;
                                changeTerminal.previousPrompt = null;
                                changeTerminal.prompt = TerminalManager.defaultPrompt;
                                changeTerminal.passwordMode = false;
                                changeTerminal.currentInput = '';
                                
                                // Clear the terminal display
                                context.clear();
                                
                                // Show welcome messages again
                                context.print('Welcome to Vista-D-NET Change Password.');
                                context.print('');
                                context.print('Type "Change" to change your password.');
                                context.print('Type "Clear" to clear the terminal.');
                                context.print('Type "Close" to close the terminal.');
                                context.print('');
                                TerminalManager.displayCommandList(changeTerminal, TerminalManager.getChangeCommandList());
                                context.print('');
                                context.print('Change password process cleared. Ready to start fresh.');
                                context.print('');
                            }, 'Clear change password terminal and start over');
                            
                            // Add Reset command
                            TerminalManager.addCommand('Change_Password_Terminal_Content_Terminal_Main_Text', 'reset', function(context) {
                                const changeTerminal = context.terminalData;
                                if (!changeTerminal) {
                                    return;
                                }
                                
                                context.print('Reset command available during information process input to reset data entry.');
                                context.print('');
                                TerminalManager.triggerPromptJump(changeTerminal);
                            }, 'Reset command for change process');
                            
                            TerminalManager.addCommand('Change_Password_Terminal_Content_Terminal_Main_Text', 'exit', function(context) {
                                const changeTerminal = context.terminalData;
                                if (!changeTerminal) {
                                    return;
                                }
                                
                                // Save current state
                                this.saveState(changeTerminal);
                                
                                // Clear the current process and return to default prompt
                                this.clearCurrentDataSet(changeTerminal);
                                
                                context.print('Process exited. Returned to default prompt.', changeTerminal);
                                this.playBeep();
                                this.render(changeTerminal);
                            }, 'Exit change password process');
                            
                            TerminalManager.addCommand('Change_Password_Terminal_Content_Terminal_Main_Text', 'close', function(context) {
                                // Clear terminal data before closing
                                const changeTerminal = TerminalManager.getTerminal('Change_Password_Terminal_Content_Terminal_Main_Text');
                                if (changeTerminal) {
                                    TerminalManager.clearTerminalData(changeTerminal);
                                    // Reset change-specific state variables to ensure default prompt on reopen
                                    changeTerminal.previousPrompt = null;
                                    changeTerminal.prompt = TerminalManager.defaultPrompt;
                                    changeTerminal.passwordMode = false;
                                }
                                document.getElementById('Change_Password_Terminal').style.display = 'none';
                            }, 'Close change password terminal');
                            
                            // Terminal-scoped input handling
                            if (!TerminalManager._changeFirstNamePatched) {
                                const previousExecuteCommand = TerminalManager.executeCommand.bind(TerminalManager);
                                TerminalManager.executeCommand = async function(raw, terminalData) {
                                    
                                    // ==================== FIRST NAME INPUT ====================
                                    if (terminalData && terminalData.id === 'Change_Password_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingChangeFirstName) {
                                    const firstName = (raw || '').trim();
                                    
                                    // Check if user wants to clear
                                    if (firstName.toLowerCase() === 'clear') {
                                        // Reset all change password state variables
                                        terminalData.awaitingChangeFirstName = false;
                                        terminalData.awaitingChangeLastName = false;
                                        terminalData.awaitingChangeDOB = false;
                                        terminalData.awaitingChangePassword = false;
                                        terminalData.awaitingChangeNewPassword = false;
                                        terminalData.changeFirstName = null;
                                        terminalData.changeLastName = null;
                                        terminalData.changeDOB = null;
                                        terminalData.changePassword = null;
                                        terminalData.changeNewPassword = null;
                                        terminalData.previousPrompt = null;
                                        terminalData.passwordMode = false;
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        terminalData.prompt = TerminalManager.defaultPrompt;
                                        
                                        this.printLine('', terminalData);
                                        this.printLine('Clearing change password process...', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }
                                    
                                    // Check if user wants to exit
                                    if (firstName.toLowerCase() === 'exit') {
                                        
                                        // Save current state
                                        this.saveState(terminalData);
                                        
                                        // Clear the current process and return to default prompt
                                        this.clearCurrentDataSet(terminalData);
                                        
                                        this.printLine('Process exited. Returned to default prompt.', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }
                                    
                                    if (!firstName) {
                                        this.render(terminalData);
                                        return;
                                    }

                                    terminalData.transcript += terminalData.prompt + firstName + '\n';
                                    terminalData.awaitingChangeFirstName = false;
                                    terminalData.changeFirstName = firstName;
                                    terminalData.awaitingChangeLastName = true;
                                    terminalData.prompt = 'Last Name: ';
                                    terminalData.currentInput = '';
                                    terminalData.shouldCapitalizeNext = true;
                                    terminalData.lastCharWasSentenceEnd = false;
                                    this.printLine('', terminalData);
                                    this.printLine('Enter your last name:', terminalData);
                                    this.playBeep();
                                    this.render(terminalData);
                                    return;
                                }

                                // ==================== LAST NAME INPUT ====================
                                if (terminalData && terminalData.id === 'Change_Password_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingChangeLastName) {
                                    const lastName = (raw || '').trim();
                                    
                                    // Check if user wants to clear
                                    if (lastName.toLowerCase() === 'clear') {
                                        // Reset all change password state variables
                                        terminalData.awaitingChangeFirstName = false;
                                        terminalData.awaitingChangeLastName = false;
                                        terminalData.awaitingChangeDOB = false;
                                        terminalData.awaitingChangePassword = false;
                                        terminalData.awaitingChangeNewPassword = false;
                                        terminalData.changeFirstName = null;
                                        terminalData.changeLastName = null;
                                        terminalData.changeDOB = null;
                                        terminalData.changePassword = null;
                                        terminalData.changeNewPassword = null;
                                        terminalData.previousPrompt = null;
                                        terminalData.passwordMode = false;
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        terminalData.prompt = TerminalManager.defaultPrompt;
                                        
                                        this.printLine('', terminalData);
                                        this.printLine('Clearing change password process...', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }
                                    
                                    // Check if user wants to exit
                                    if (lastName.toLowerCase() === 'exit') {
                                        
                                        // Save current state
                                        this.saveState(terminalData);
                                        
                                        // Clear the current process and return to default prompt
                                        this.clearCurrentDataSet(terminalData);
                                        
                                        this.printLine('Process exited. Returned to default prompt.', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }
                                    
                                    if (!lastName) {
                                        this.render(terminalData);
                                        return;
                                    }

                                    terminalData.transcript += terminalData.prompt + lastName + '\n';
                                    terminalData.awaitingChangeLastName = false;
                                    terminalData.changeLastName = lastName;
                                    terminalData.awaitingChangeDOB = true;
                                    terminalData.prompt = 'Day (DD): ';
                                    terminalData.currentInput = '';
                                    terminalData.shouldCapitalizeNext = true;
                                    terminalData.lastCharWasSentenceEnd = false;
                                    this.printLine('', terminalData);
                                    this.printLine('Enter your date of birth:', terminalData);
                                    this.printLine('Day (numbers only):', terminalData);
                                    this.playBeep();
                                    this.render(terminalData);
                                    return;
                                }

                                // ==================== DOB INPUT ====================
                                if (terminalData && terminalData.id === 'Change_Password_Terminal_Content_Terminal_Main_Text' && terminalData.awaitingChangeDOB) {
                                    const input = (raw || '').trim();
                                    
                                    // Check if user wants to clear
                                    if (input.toLowerCase() === 'clear') {
                                        // Reset all change password state variables
                                        terminalData.awaitingChangeFirstName = false;
                                        terminalData.awaitingChangeLastName = false;
                                        terminalData.awaitingChangeDOB = false;
                                        terminalData.awaitingChangePassword = false;
                                        terminalData.awaitingChangeNewPassword = false;
                                        terminalData.changeFirstName = null;
                                        terminalData.changeLastName = null;
                                        terminalData.changeDOB = null;
                                        terminalData.changePassword = null;
                                        terminalData.changeNewPassword = null;
                                        terminalData.previousPrompt = null;
                                        terminalData.passwordMode = false;
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        terminalData.prompt = TerminalManager.defaultPrompt;
                                        
                                        this.printLine('', terminalData);
                                        this.printLine('Clearing change password process...', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }
                                    
                                    // Check if user wants to exit
                                    if (input.toLowerCase() === 'exit') {
                                        
                                        // Save current state
                                        this.saveState(terminalData);
                                        
                                        // Clear the current process and return to default prompt
                                        this.clearCurrentDataSet(terminalData);
                                        
                                        this.printLine('Process exited. Returned to default prompt.', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                        return;
                                    }
                                    
                                    // Initialize DOB object if not exists
                                    if (!terminalData.changeDOB) {
                                        terminalData.changeDOB = { month: null, day: null, year: null };
                                    }
                                    
                                    // Handle Day input
                                    if (terminalData.prompt === 'Day (DD): ') {
                                        // Check if input is exactly 2 digits or is Reset command
                                        if (input.length !== 2 && input.toLowerCase() !== 'reset') {
                                            this.printLine('Error: Day must be exactly 2 digits (e.g., 01, 05, 12) or type "Reset" to reset DOB.', terminalData);
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Handle Reset command
                                        if (input.toLowerCase() === 'reset') {
                                            const isDayPrompt = (terminalData.prompt || '').trim().startsWith('Day (DD):');

                                            if (isDayPrompt) {
                                                // Reset to first-name entry when reset is executed on day prompt
                                                terminalData.awaitingChangeFirstName = true;
                                                terminalData.awaitingChangeLastName = false;
                                                terminalData.awaitingChangeDOB = false;
                                                terminalData.changeFirstName = null;
                                                terminalData.changeLastName = null;
                                                terminalData.changeDOB = null;
                                                terminalData.prompt = 'First Name: ';
                                            } else {
                                                // Reset DOB entry back to day prompt for month/year
                                                terminalData.awaitingChangeFirstName = false;
                                                terminalData.awaitingChangeLastName = false;
                                                terminalData.awaitingChangeDOB = true;
                                                terminalData.changeDOB = null;
                                                terminalData.prompt = 'Day (DD): ';
                                            }
                                            
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            terminalData.passwordMode = false;
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('DOB reset. Starting fresh:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        const day = parseInt(input);
                                        if (day < 1 || day > 31) {
                                            this.printLine('Error: Day must be between 01 and 31.', terminalData);
                                            this.render(terminalData);
                                            return;
                                        }
                                        terminalData.transcript += terminalData.prompt + input + '\n';
                                        terminalData.changeDOB.day = input;
                                        terminalData.prompt = 'Month (MM): ';
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        this.printLine('', terminalData);
                                        this.printLine('Month (numbers only):', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                    } else if (terminalData.prompt === 'Month (MM): ') {
                                        // Check if input is exactly 2 digits or is Reset command
                                        if (input.length !== 2 && input.toLowerCase() !== 'reset') {
                                            this.printLine('Error: Month must be exactly 2 digits (e.g., 01, 05, 12) or type "Reset" to reset DOB.', terminalData);
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Handle Reset command
                                        if (input.toLowerCase() === 'reset') {
                                            // Reset DOB completely
                                            terminalData.changeDOB = null;
                                            terminalData.prompt = 'Day (DD): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('DOB reset. Starting fresh:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        const month = parseInt(input);
                                        if (month < 1 || month > 12) {
                                            this.printLine('Error: Month must be between 01 and 12.', terminalData);
                                            this.render(terminalData);
                                            return;
                                        }
                                        terminalData.transcript += terminalData.prompt + input + '\n';
                                        terminalData.changeDOB.month = input;
                                        terminalData.prompt = 'Year (YYYY): ';
                                        terminalData.currentInput = '';
                                        terminalData.shouldCapitalizeNext = true;
                                        terminalData.lastCharWasSentenceEnd = false;
                                        this.printLine('', terminalData);
                                        this.printLine('Year (numbers only):', terminalData);
                                        this.playBeep();
                                        this.render(terminalData);
                                    } else if (terminalData.prompt === 'Year (YYYY): ') {
                                        // Check if input is exactly 4 digits or is Reset command
                                        if (input.length !== 4 && input.toLowerCase() !== 'reset') {
                                            this.printLine('Error: Year must be exactly 4 digits (e.g., 1990, 2005) or type "Reset" to reset DOB.', terminalData);
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // Handle Reset command
                                        if (input.toLowerCase() === 'reset') {
                                            // Reset DOB completely
                                            terminalData.changeDOB = null;
                                            terminalData.prompt = 'Day (DD): ';
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            
                                            this.printLine('', terminalData);
                                            this.printLine('DOB reset. Starting fresh:', terminalData);
                                            this.playBeep();
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        const year = parseInt(input);
                                        if (year < 1900 || year > 2025) {
                                            this.printLine('Error: Year must be between 1900 and 2025 or type "Reset" to reset DOB.', terminalData);
                                            this.render(terminalData);
                                            return;
                                        }
                                        
                                        // DOB complete - look up backup hash
                                        terminalData.transcript += terminalData.prompt + input + '\n';
                                        terminalData.changeDOB.year = input;
                                        terminalData.awaitingChangeDOB = false;
                                        terminalData.previousPrompt = null;
                                        
                                        this.printLine('', terminalData);
                                        this.printLine('Date of birth: ' + terminalData.changeDOB.month + '/' + terminalData.changeDOB.day + '/' + terminalData.changeDOB.year, terminalData);
                                        this.printLine('', terminalData);
                                        
                                        // Generate backup hash to look up
                                        try {
                                            const encoder = new TextEncoder();
                                            const toSha256Hex = async (inputValue) => {
                                                const data = encoder.encode(inputValue);
                                                const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                                                const hashArray = Array.from(new Uint8Array(hashBuffer));
                                                return hashArray.map(b => b.toString(16).padStart(2, '0')).join('').toUpperCase();
                                            };

                                            const backupCombined = terminalData.changeFirstName + terminalData.changeLastName + terminalData.changeDOB.month + terminalData.changeDOB.day + terminalData.changeDOB.year;
                                            const backupHashHex = await toSha256Hex(backupCombined);
                                            
                                            // Look up the backup hash in the database
                                            let accountFound = false;
                                            let hashData = null;
                                            if (window.HashDatabase) {
                                                try {
                                                    hashData = await window.HashDatabase.getHash(backupHashHex);
                                                    accountFound = !!hashData;
                                                } catch (dbError) {
                                                    this.printLine('ERROR: Failed to lookup account.', terminalData);
                                                    terminalData.prompt = TerminalManager.defaultPrompt;
                                                    this.render(terminalData);
                                                    return;
                                                }
                                            } else {
                                                this.printLine('ERROR: Database system not available', terminalData);
                                                terminalData.prompt = TerminalManager.defaultPrompt;
                                                this.render(terminalData);
                                                return;
                                            }
                                            
                                            if (accountFound && hashData) {
                                                this.printLine('Account found:', terminalData);
                                                this.printLine('"' + backupHashHex + '"', terminalData);
                                                this.printLine('Password associated with account: ' + hashData.password, terminalData);
                                                this.printLine('', terminalData);
                                            } else {
                                                this.printLine('ERROR: No account found with matching information', terminalData);
                                                this.printLine('Please check your name and date of birth', terminalData);
                                                this.printLine('', terminalData);
                                            }
                                            
                                            // Return to default prompt
                                            terminalData.prompt = TerminalManager.defaultPrompt;
                                            terminalData.currentInput = '';
                                            terminalData.shouldCapitalizeNext = true;
                                            terminalData.lastCharWasSentenceEnd = false;
                                            this.render(terminalData);
                                            
                                        } catch (error) {
                                            this.printLine('Error generating backup hash: ' + error.message, terminalData);
                                            terminalData.prompt = TerminalManager.defaultPrompt;
                                            this.render(terminalData);
                                        }
                                        
                                        return;
                                    }

                                    this.render(terminalData);
                                    return;
                                }
                                
                                // Fall back to previous executeCommand for other cases
                                return previousExecuteCommand(raw, terminalData);
                            };
                            
                            TerminalManager._changeFirstNamePatched = true;
                            }
                        });
                    </script>
                </div>

                <style aria-label="Change_Password_Terminal - Style">
                   
                </style>

                <script aria-label="Change_Password_Terminal - Script">
                    document.getElementById('Change_Password_Terminal_Close').addEventListener('click', function() {
                        // Clear terminal data before closing
                        const changeTerminal = TerminalManager.getTerminal('Change_Password_Terminal_Content_Terminal_Main_Text');
                        if (changeTerminal) {
                            TerminalManager.clearTerminalData(changeTerminal);
                            // Reset change-specific state variables to ensure default prompt on reopen
                            changeTerminal.previousPrompt = null;
                            changeTerminal.prompt = TerminalManager.defaultPrompt;
                            changeTerminal.passwordMode = false;
                        }
                        document.getElementById('Change_Password_Terminal').style.display = 'none';
                    });
                </script>
            </div>

    </div>
</body>
</html>
